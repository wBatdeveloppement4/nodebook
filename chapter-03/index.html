<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Jouer avec JavaScript</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style type="text/css">.interactive--javascript code[data-lang]:before {
  display: block;
  color: #00c72b;
  font-weight: bold;
  cursor: pointer;
}

  [lang="en"] .interactive--javascript code[data-lang]:before {
    content: "▶ run code";
  }
  [lang="fr"] .interactive--javascript code[data-lang]:before {
    content: "▶ voir le résultat";
  }
  .interactive--javascript code[data-label]:before {
    content: attr(data-label);
  }

.interactive iframe {
  position: absolute;
  visibility: hidden;
}

.interactive.status--loaded iframe {
  position: inherit;
  visibility: visible;
}

.interactive.status--loading {
  opacity: .5;
}
</style><script src="https://embed.runkit.com/" defer async></script><script>(function(){
        function makeListingInteractive(element){
  if (element.classList.contains('interactive--installed')) {
    return;
  }

  const code = element.querySelector('code');
  const source = code
    .textContent
    .replace(/\(\d+\)$/gm, '')
    .replace(/^["']?use strict["'][; ]*\n/, '');

  element.classList.add('status--loading');

  // eslint-disable-next-line no-undef
  RunKit.createNotebook({
    element: element,
    source: source,
    onLoad: function(ntbk) {
      element.classList.add('interactive--installed');
      element.classList.remove('status--loading');
      element.classList.add('status--loaded');
      code.parentNode.setAttribute('hidden', true);

      ntbk.evaluate();
    }
  });
}
function installEvents() {
  function getParent(el, condition) {
    let parent = el;

    while(parent = parent.parentNode) {
      if (condition(parent)) {
        return parent;
      }
    }
  }

  function hasClass(className) {
    return function check(el) {
      return el.classList.contains(className);
    }
  }

  document.querySelector('body').addEventListener('click', function(el) {
    if (el.target.classList.contains('language-javascript')) {
      const parentNode = getParent(
        el.target,
        hasClass('interactive--javascript')
      );

      makeListingInteractive(parentNode);
    }
  });
}

        document.addEventListener('DOMContentLoaded', installEvents);
      })();</script>
<style type="text/css">
.listingblock [data-bash-subs]::before{
  content: attr(data-bash-subs) " ";
  opacity: .5; }
</style>
<style type="text/css">
.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, #toctitle {
  font-style: normal;
  font-weight: bold;
}
a {
  white-space: nowrap;
}
.RemarquePreTitre {
	font-style: normal;
  font-weight: bold;
	border-bottom: 1px solid #ddddd8;
}
.icon .title {
  font-size: 2em;
}
</style>
</head>
<body class="book">
<div id="header">
<h1>Jouer avec JavaScript</h1>
<div class="details">
<span id="revdate">2018-03-06</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Programmer une application Node c&#8217;est aussi
l&#8217;occasion d&#8217;apprendre JavaScript.
Ou de se mettre à jour ou de redécouvrir le langage.</p>
</div>
<div class="paragraph">
<p>Ce chapitre explique ce qu&#8217;il faut pour
comprendre comment fonctionne JavaScript.
Nous utiliserons une approche par l&#8217;exemple.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<div class="title">Sommaire</div>
<ul>
<li>
<p>Qu&#8217;est-ce que JavaScript, pour de vrai ?</p>
</li>
<li>
<p>Comprendre l&#8217;évolution de la spécification ECMAScript</p>
</li>
<li>
<p>Manipuler les différentes structures du langage</p>
</li>
<li>
<p>En savoir plus sur des éléments avancés du langage</p>
</li>
</ul>
</div>
</div>
</div>
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>JavaScript est souvent raillé.
Parce que ce n&#8217;est pas un vrai langage.
Parce qu&#8217;il a été créé en 6 jours.
Parce qu&#8217;il n&#8217;est pas orienté objet.</p>
</div>
<div class="paragraph">
<p>JavaScript est un langage expressif qui a énormément gagné en maturité
depuis les années 2010.
Il se révèle parfaitement opérationnel dès lors que l&#8217;on s&#8217;intéresse
à ses fonctionnalités, sans faire de hors-piste.</p>
</div>
<div class="paragraph">
<p>Les types de données et les méthodes de manipulations qu&#8217;elles nous offrent
permettent d&#8217;écrire un code plus simple, à lire et à produire.
Certaines structures de données nous aident à mieux organiser nos données
ainsi qu&#8217;à mieux les traiter.</p>
</div>
</blockquote>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table des matières</div>
<ul class="sectlevel1">
<li><a href="#definition">1. Qu&#8217;est-ce que JavaScript ?</a>
<ul class="sectlevel2">
<li><a href="#ecmascript_5_aka_em_es5_em">1.1. ECMAScript 5 (aka <em>ES5</em>)</a></li>
<li><a href="#ecmascript_2015_aka_em_es6_em_puis_em_es2015_em">1.2. ECMAScript 2015 (aka <em>ES6</em> puis <em>ES2015</em>)</a></li>
<li><a href="#ecmascript_2016_etc_aka_em_es2016_em">1.3. ECMAScript 2016, etc. (aka <em>ES2016</em>…)</a></li>
</ul>
</li>
<li><a href="#primitives">2. Les éléments de base du langage</a>
<ul class="sectlevel2">
<li><a href="#les_variables">2.1. Les variables</a></li>
<li><a href="#instructions">2.2. Instructions</a></li>
<li><a href="#scope">2.3. Portée (<em>scope</em>)</a></li>
</ul>
</li>
<li><a href="#string">3. Manipuler du texte</a>
<ul class="sectlevel2">
<li><a href="#regexp">3.1. Expressions régulières (<em>RegExp</em>)</a></li>
</ul>
</li>
<li><a href="#boolean">4. Manipuler des booléens</a></li>
<li><a href="#number">5. Manipuler des nombres (<em>Number</em>, <em>Math</em>)</a>
<ul class="sectlevel2">
<li><a href="#opérations_mathématiques">5.1. Opérations mathématiques</a></li>
<li><a href="#les_nombres_qui_n_en_sont_pas_em_nan_em">5.2. Les nombres qui n&#8217;en sont pas (<em>NaN</em>)</a></li>
<li><a href="#convertir_en_nombre">5.3. Convertir en nombre</a></li>
<li><a href="#formater_et_arrondir_des_nombres">5.4. Formater et arrondir des nombres</a></li>
</ul>
</li>
<li><a href="#functions">6. Manipuler des fonctions</a>
<ul class="sectlevel2">
<li><a href="#anonymous-function">6.1. Les fonctions anonymes</a></li>
<li><a href="#callback">6.2. Les fonctions de <em>callback</em></a></li>
<li><a href="#rest-parameters">6.3. Paramètres du reste (<em>rest parameters</em>)</a></li>
</ul>
</li>
<li><a href="#array">7. Manipuler des tableaux (<em>Array</em>)</a>
<ul class="sectlevel2">
<li><a href="#créer_des_tableaux_à_partir_d_autres_valeurs">7.1. Créer des tableaux à partir d&#8217;autres valeurs</a></li>
<li><a href="#array.concat">7.2. Combiner des tableaux</a></li>
<li><a href="#array.forEach">7.3. Itérer sur les valeurs avec des boucles</a></li>
<li><a href="#array.sort">7.4. Trier les valeurs</a></li>
<li><a href="#array.map">7.5. Transformer les valeurs</a></li>
<li><a href="#array.filter">7.6. Filtrer les valeurs</a></li>
<li><a href="#array.find">7.7. Identifier une ou plusieurs valeurs</a></li>
<li><a href="#array-destructuring">7.8. Décomposition de tableau (<em>destructuring</em>)</a></li>
</ul>
</li>
<li><a href="#object">8. Manipuler des structures d&#8217;objet</a>
<ul class="sectlevel2">
<li><a href="#object-destructuring">8.1. Décomposition d&#8217;objet (<em>destructuring</em>)</a></li>
<li><a href="#object.assign">8.2. Combiner des objets</a></li>
<li><a href="#itérer_sur_des_objets">8.3. Itérer sur des objets</a></li>
<li><a href="#identifier_une_ou_plusieurs_valeurs">8.4. Identifier une ou plusieurs valeurs</a></li>
</ul>
</li>
<li><a href="#json">9. Manipuler des structures de données JSON</a></li>
<li><a href="#date">10. Manipuler des dates</a>
<ul class="sectlevel2">
<li><a href="#intl.datetimeformat">10.1. Formatage internationalisé (<em>Intl.DateTimeFormat</em>)</a></li>
</ul>
</li>
<li><a href="#class">11. Manipuler des classes d&#8217;objet (<em>Class</em>)</a>
<ul class="sectlevel2">
<li><a href="#class.method">11.1. Méthodes d&#8217;instance</a></li>
<li><a href="#class.static">11.2. Méthodes statiques</a></li>
<li><a href="#object-getset">11.3. Accesseurs et mutateurs</a></li>
<li><a href="#class.extends">11.4. Héritage</a></li>
</ul>
</li>
<li><a href="#promise">12. Manipuler des promesses (<em>Promise</em>)</a>
<ul class="sectlevel2">
<li><a href="#promise.all">12.1. Collection de promesses</a></li>
<li><a href="#async-await">12.2. async/await</a></li>
</ul>
</li>
<li><a href="#conclusion">13. Conclusion</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="definition">1. Qu&#8217;est-ce que JavaScript ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Au lieu d&#8217;écrire plusieurs paragraphes expliquant ce qu&#8217;est et
ce que n&#8217;est <em>pas</em> JavaScript, regardons ensemble
un bloc de code contenant plusieurs <em>expressions</em> écrites
en JavaScript :</p>
</div>
<div class="listingblock">
<div class="title">definition.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">'use strict';

// On concatène 2 chaînes de caractères <b class="conum">(1)</b>
const baseUrl = 'https://oncletom.io/node.js';
const filePath = `${baseUrl}/package.json`;

// On affiche un message au clic sur la page <b class="conum">(2)</b>
const docBody = document.querySelector('body');
docBody.addEventListener('click', () =&gt; alert('Hello World!'));

// On affiche des informations contenues dans un fichier distant <b class="conum">(3)</b>
fetch(filePath)
  .then(response =&gt; response.json())
  .then(pkg =&gt; console.log(`${pkg.name}@${pkg.version}`));

// On liste le contenu du répertoire utilisateur <b class="conum">(4)</b>
const {homedir} = require('os');
const fs = require('fs');
fs.readdir(homedir(), (err, files) =&gt; {
  err ? console.error(err) : console.log(files);
});</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Code JavaScript standard ;</p>
</li>
<li>
<p>Code JavaScript pour manipuler la DOM API (documents web) ;</p>
</li>
<li>
<p>Code JavaScript pour manipuler des Web API (fonctionnalités des navigateurs web) ;</p>
</li>
<li>
<p>Code JavaScript pour manipuler Node.js.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ce que l&#8217;on peut comprendre de l&#8217;exemple de code ci-dessus,
c&#8217;est que JavaScript permet de s&#8217;interfacer avec plusieurs choses :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>des documents web représentés par le Document Object Model (DOM) ;</p>
</li>
<li>
<p>des navigateurs web au travers des Web API ;</p>
</li>
<li>
<p>des systèmes informatiques avec Node.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><em>ECMAScript</em> correspond à l&#8217;ensemble des expressions du langage.
Ces expressions sont étendues par des interfaces de programmation (<em>API</em>).
Ces interfaces nous permettent de communiquer avec les documents web, les navigateurs web ou les systèmes informatiques.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">💬</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Histoire</span> À propos de JavaScript</div>
<div class="paragraph">
<p>JavaScript a été inventé en 1995 par Brendan Eich alors qu&#8217;il était employé de la société <em>Netscape Communications</em>.
Microsoft lui emboîte le pas en incluant JavaScript dans son logiciel Internet Explorer, alors en version 3.
Pour des raisons de droits de marque, il y est dénommé <em>JScript</em>.</p>
</div>
<div class="paragraph">
<p>La spécification est ensuite validée par l&#8217;organisme <em>Ecma International</em> en juin 1997 sous le nom d'<em>ECMAScript</em>, standard ECMA-262.</p>
</div>
<div class="paragraph">
<p>L&#8217;utilisation du terme <em>JavaScript</em> est resté dans le vocabulaire courant. Mais c&#8217;est bien d'<em>ECMAScript</em> dont on parle, vraiment.</p>
</div>
<div class="paragraph">
<p>Adobe Flash utilise un dérivé d&#8217;ECMAScript : ActionScript.
Bien des machines virtuelles sont capables d&#8217;interpréter partiellement ou intégralement ECMAScript : Rhino, Konq, BESEN en Object Pascal ou encore Esprima qui est elle-même écrite en… ECMAScript.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si d&#8217;autres langages de programmation se cantonnent
soit au <em>côté client</em> (VBScript, ActionScript, Elm)
soit au <em>côté serveur</em> (Ruby, Python, Haskell),
JavaScript a débuté <em>côté client</em> pour s&#8217;étendre au <em>côté serveur</em>.
Ce à quoi se réfère l&#8217;expression anglophone <em>full stack</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/javascript.svg" alt="javascript">
</div>
<div class="title">Figure 1. Écosystème des technologies JavaScript.</div>
</div>
<div class="paragraph">
<p>Le langage <em>ECMAScript</em> — appelons-le ainsi à partir de maintenant —
a évolué au fil du temps.
Il s&#8217;est enrichi au fur et à mesure de nouvelles fonctionnalités,
de sucres syntaxiques (raccourcis d&#8217;écriture)
et de rigueur aussi, pour corriger des défauts de <em>design</em>.</p>
</div>
<div class="paragraph">
<p>Le comité de travail <em>TC39</em> (<em>Technical Committee</em>,
<span class="URL"><a href="https://github.com/tc39" class="bare">github.com/tc39</a></span>) est en charge de l&#8217;évolution
du langage, standardisé sous le doux sobriquet de <em>standard ECMA-262</em>.
À charge ensuite aux différents implémenteurs de suivre les changements
et de les incorporer dans leurs machines virtuelles.</p>
</div>
<div class="paragraph">
<p>Node se base sur la machine virtuelle <a href="../chapter-01/index.html#v8">V8 de Google</a> pour interpréter les expressions ECMAScript.
De fait, Node comprend les mêmes expressions ECMAScript que <em>V8</em>.</p>
</div>
<div class="paragraph">
<p>Nous verrons un peu plus tard dans ce chapitre comment suivre la
compatibilité de Node avec ECMAScript.
Intéressons-nous à l&#8217;évolution du langage, et ce que ça nous apporte.</p>
</div>
<div class="sect2">
<h3 id="ecmascript_5_aka_em_es5_em">1.1. ECMAScript 5 (aka <em>ES5</em>)</h3>
<div class="paragraph">
<p>ECMAScript a été standardisé dans sa version 5 en décembre 2009.
La révision 5.1 de juin 2011 est une correction mineure de la spécification.</p>
</div>
<div class="paragraph">
<p>Il s&#8217;agit d&#8217;une évolution majeure dans l&#8217;histoire du langage.
La précédente version — ECMAScript 3 — était âgée de… <strong>dix ans</strong>…</p>
</div>
<div class="paragraph">
<p>ECMAScript 5 limite drastiquement certains effets indésirables du langage
grâce au <em>mode strict</em>.
De nouvelles méthodes de manipulation de tableaux et d&#8217;objets voient le jour
ainsi qu&#8217;un support natif du format de données <a href="#json">JSON</a>.</p>
</div>
<div class="paragraph">
<p>La standardisation de cette version d&#8217;ECMAScript a contribué à redorer
l&#8217;image du langage mais aussi à faire émerger de nouvelles pratiques
de programmation.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Table de compatibilité
</td>
<td class="hdlist2">
<p><span class="URL"><a href="https://kangax.github.io/compat-table/es5/" class="bare">kangax.github.io/compat-table/es5/</a></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Spécification
</td>
<td class="hdlist2">
<p><span class="URL"><a href="https://www.ecma-international.org/ecma-262/5.1/" class="bare">www.ecma-international.org/ecma-262/5.1/</a></span></p>
</td>
</tr>
</table>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/compat-table.png" alt="compat table" width="85%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="ecmascript_2015_aka_em_es6_em_puis_em_es2015_em">1.2. ECMAScript 2015 (aka <em>ES6</em> puis <em>ES2015</em>)</h3>
<div class="paragraph">
<p>La spécification <strong>ECMAScript 2015</strong> (<em>ES2015</em>) a été publiée en juin 2015.
Elle succède à <strong>ECMAScript 5</strong> après 6 années de gestation.<br>
Cette version a successivement été appelée <em>ECMAScript Harmony</em>, <em>ECMAScript 6</em>, puis <em>ECMAScript 2015</em>.</p>
</div>
<div class="paragraph">
<p>Le processus de standardisation a mis 6 années pour aboutir,
mais cette fois-ci, les choses se sont déroulées différemment.<br>
De nombreuses idées ont été piochées dans le langage
<em>CoffeeScript</em> (<span class="URL"><a href="http://coffeescript.org" class="bare">coffeescript.org</a></span>).
Et surtout, un nouveau type d&#8217;outillage s&#8217;est formé pour commencer
à utiliser ce JavaScript du futur avec les compilateurs
<em>traceur</em> de Google dès 2011 (<span class="URL"><a href="https://github.com/google/traceur-compiler" class="bare">github.com/google/traceur-compiler</a></span>)
puis le projet indépendant <em>6to5</em> dès 2014.
<em>6to5</em> a été renommé en <em>babel</em> (<span class="URL"><a href="https://babeljs.io" class="bare">babeljs.io</a></span>)
et son instigateur a par la suite été embauché par Facebook.</p>
</div>
<div class="paragraph">
<p>La pratique de compiler du JavaScript en JavaScript était en rupture
avec ce qui se faisait précédemment :
attendre qu&#8217;une fonctionnalité soit adoptée par un dénominateur commun
de navigateurs web pour s&#8217;en servir.
Cette fois-ci, on pouvait se servir du futur, dès aujourd&#8217;hui.</p>
</div>
<div class="paragraph">
<p>De fait, il n&#8217;y a pas eu à attendre 6 ans et l&#8217;implémentation
par les différents implémenteurs pour profiter de ce
qu&#8217;il y avait de meilleur.</p>
</div>
<div class="paragraph">
<p>Le prix à payer ? Un ticket d&#8217;entrée plus élevé lié à la maitrise
de l&#8217;outillage associé.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Table de compatibilité (navigateurs web)
</td>
<td class="hdlist2">
<p><span class="URL"><a href="https://kangax.github.io/compat-table/es6/" class="bare">kangax.github.io/compat-table/es6/</a></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Table de compatibilité (Node.js)
</td>
<td class="hdlist2">
<p><span class="URL"><a href="http://node.green/" class="bare">node.green/</a></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Spécification
</td>
<td class="hdlist2">
<p><span class="URL"><a href="https://www.ecma-international.org/ecma-262/6.0/" class="bare">www.ecma-international.org/ecma-262/6.0/</a></span></p>
</td>
</tr>
</table>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/node-green.png" alt="node green" width="85%">
</div>
<div class="title">Figure 2. Illustration de l&#8217;évolution de la compatibilité ECMAScript au fil des versions de Node.</div>
</div>
</div>
<div class="sect2">
<h3 id="ecmascript_2016_etc_aka_em_es2016_em">1.3. ECMAScript 2016, etc. (aka <em>ES2016</em>…)</h3>
<div class="paragraph">
<p>Depuis la sortie d'<em>ECMAScript 2015</em>, l&#8217;intention est de publier une
nouvelle spécification par an.
L&#8217;envie était de travailler fonctionnalité par fonctionnalité
et de ne pas attendre trop longtemps avant de les ratifier.
En conséquent, les nouvelles versions annuelles sont beaucoup plus
incrémentales.
Elles se font moins attendre et contiennent moins de grands bouleversements.</p>
</div>
<div class="paragraph">
<p>Les fonctionnalités en cours de préparation sont listées
dans ce dépôt GitHub : <span class="URL"><a href="https://github.com/tc39/proposals" class="bare">github.com/tc39/proposals</a></span>.
Le dernier stade avant la validation d&#8217;une fonctionnalité est le <em>stage 3</em>.
Dès qu&#8217;une fonctionnalité passe en <em>stage 4</em>, elle est incluse
dans la prochaine version d&#8217;ECMAScript
— <em>ECMAScript 2018</em> une fois l&#8217;année 2018 terminée.</p>
</div>
<div class="paragraph">
<p>Les fonctionnalités approuvées sont consignées dans ce document :
<span class="URL"><a href="https://github.com/tc39/proposals/blob/master/finished-proposals.md" class="bare">github.com/tc39/proposals/blob/master/finished-proposals.md</a></span>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="primitives">2. Les éléments de base du langage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ECMAScript permet de manipuler différents <em>types</em> de données.
Cette section s&#8217;intéresse à décrire les notions nécessaires
pour s&#8217;approprier le reste des exemples de l&#8217;ouvrage.
On apprendra notamment à manipuler des variables, à faire
des boucles sur des collections et à faire la différence
entre un objet et une fonction.</p>
</div>
<div class="paragraph">
<p>Mais qu&#8217;entend-t-on par <em>type de données</em> ?
Faisons-nous notre propre idée avec une suite d&#8217;exemples.
Ces notions seront développées dans le reste du chapitre,
pour mieux comprendre ce que l&#8217;on peut en faire.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/string.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">'Node.js'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Une valeur entourée de guillemets est considérée
par l&#8217;interpréteur ECMAScript comme une <strong>chaîne de caractères</strong>, du texte.</p>
</div>
<div class="paragraph">
<p>Ces guillemets peuvent être des guillemets simples (<code>'</code>),
des guillemets doubles (<code>"</code>) ou des guillemets obliques (<code>`</code>).</p>
</div>
<div class="paragraph">
<p>On peut effectuer des opérations d&#8217;identification ou d&#8217;assemblage avec une
valeur de <em>type chaîne de caractères</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/number.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">3

12.3</code></pre>
</div>
</div>
<div class="paragraph">
<p>ECMAScript considère les entiers (<code>3</code> dans cet exemple)
et les nombres flottants (<code>12.3</code> dans cet exemple) comme des nombres.
Il ne fait <em>pas</em> de distinction entre les deux.</p>
</div>
<div class="paragraph">
<p>On peut effectuer des <strong>opérations mathématiques</strong> entre plusieurs
valeurs de <em>type nombre</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/boolean.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">true

false</code></pre>
</div>
</div>
<div class="paragraph">
<p>ECMAScript considère deux valeurs pour signifier <em>vrai</em> ou <em>faux</em>,
respectivement <code>true</code> et <code>false</code>.</p>
</div>
<div class="paragraph">
<p>On peut effectuer des <strong>opérations logiques</strong> avec une
valeur de <em>type booléen</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/null.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">null</code></pre>
</div>
</div>
<div class="paragraph">
<p>On utilise <code>null</code> pour signifier l'<strong>absence de valeur</strong>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/undefined.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">undefined</code></pre>
</div>
</div>
<div class="paragraph">
<p>La valeur <code>undefined</code> est utilisée pour signifier
qu&#8217;une <strong>valeur est inconnue</strong>.
Rares sont les cas où on choisira ce type de données par nous-même.</p>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> primitives</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur primitives.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Data_structures" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Data_structures</a>

</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Il existe trois autres types de données qui se basent sur ces types
dits <em>primitifs</em>.
Ces autres types sont destinés à ranger, classer et
à exprimer de nouvelles valeurs en fonction d&#8217;autres.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/array.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">[2, 'C', 2, 'G']</code></pre>
</div>
</div>
<div class="paragraph">
<p>Un tableau se déclare en encadrant une suite de valeurs entre crochets
(<code>[</code> et <code>]</code>).
Un tableau peut contenir n&#8217;importe quel type de valeurs,
et autant que nécessaire.
L&#8217;ordre des valeurs a généralement une importance.</p>
</div>
<div class="paragraph">
<p>On peut effectuer des <strong>opérations de tri et de sélection</strong> avec un
<em>tableau de valeurs</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/object.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  title: 'Node.js',
  isbn: '978-2212139938',
  published: true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Un objet se déclare en encadrant une suite de <em>paires de valeurs</em>
entre accolade (<code>{</code> et <code>}</code>).
Une <em>clé</em> désigne une <em>valeur</em>, qui peut être de n&#8217;importe quel type.
Un objet a principe proche d&#8217;un <em>dictionnaire</em> : on associe une valeur
à un intitulé, un label.
L&#8217;ordre des valeurs n&#8217;a généralement pas d&#8217;importance.</p>
</div>
<div class="paragraph">
<p>On peut effectuer des <strong>opérations de sélection</strong> avec un
<em>objet de valeurs</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/function.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function double(value) {
  return value * 2;
}

double(3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Une fonction accepte des <em>arguments</em>, de n&#8217;importe quel type et
autant que nécessaire.
Une fonction peut être <em>déclarée</em> et être <em>exécutée</em> (dernière ligne de l&#8217;exemple précédent).</p>
</div>
<div class="paragraph">
<p>Une fonction <em>retourne</em> un résultat explicite avec le
mot-clé <code>return</code>.
Dans le cas contraire, ECMAScript considère
que la valeur retournée équivaut implicitement à <code>undefined</code>.</p>
</div>
<div class="paragraph">
<p>On peut effectuer des <strong>opérations de transformation</strong> avec une fonction.</p>
</div>
<div class="paragraph">
<p>Les fonctions sont destinées à être <em>appelées</em>, pour effectuer
des traitements répétitifs.
Dès que l&#8217;on sent que l&#8217;on doit écrire deux fois la même chose,
on l&#8217;écrit dans une fonction et on l&#8217;appelle deux fois.</p>
</div>
<div class="sect2">
<h3 id="les_variables">2.1. Les variables</h3>
<div class="paragraph">
<p>Les <strong>variables</strong> servent à ranger des valeurs.
On peut ainsi les réutiliser plus tard, les transmettre et prendre
des décisions en fonction de ce qu&#8217;elles contiennent.</p>
</div>
<div class="paragraph">
<p>Les variables nous aident à <em>donner du sens</em> à notre code,
à le rendre intelligible par d&#8217;autres personnes
ainsi qu&#8217;à nommer des choses comme on le ferait dans notre quotidien.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">base/variables.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const book = {
  title: 'Node.js',
  isbn: '978-2212139938',
  published: true
};

const base_price = 13;

function double(value) {
  return value * 2;
}

book.price = double(base_price);</code></pre>
</div>
</div>
<div class="paragraph">
<p>À votre avis, combien vaut le prix du livre calculé dans
l&#8217;exemple précédent ?
Il suffirait de suivre le chemin que prend la nouvelle valeur
rangée dans la clé <code>price</code> de l&#8217;objet <code>book</code>, calculée par la fonction
<code>double</code> à qui on passe la valeur contenue dans la variable <code>base_price</code>.</p>
</div>
<div class="paragraph">
<p>Le mot-clé <code>const</code> nous a servi à <em>déclarer</em> des variables.
On ne peut étiqueter une variable avec le même nom qu&#8217;une seule fois.
L&#8217;exemple suivant générera une erreur si on déclare deux fois la même variable avec <code>const</code> :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">variables/const.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const base_price = 13;
const base_price = 14;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="instructions">2.2. Instructions</h3>
<div class="paragraph">
<p>Des <em>instructions</em> nous servent à suivre, éviter ou répéter
des chemins dans notre code.</p>
</div>
<div class="paragraph">
<p>L&#8217;instruction <code>if</code> nous aide à exécuter du code qui remplit une condition.
Cette condition peut être une <em>valeur</em> ou une <em>expression</em>.
Cette expression est interprétée pour savoir à quel <em>booléen</em>
elle correspond.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">instructions/if.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const book = {
  title: 'Node.js',
  published: true
};

if (book.published &amp;&amp; book.title) {
  console.log('Le livre est publié (et a un titre)');
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent vérifie que les deux conditions sont remplies
(opérateur <code>&amp;&amp;</code>) pour afficher un message en conséquent.</p>
</div>
<div class="paragraph">
<p>On notera au passage que <code>book.title</code> n&#8217;est pas un booléen.
ECMAScript regarde dans ce cas que la chaîne de caractères
contient <em>au moins 1 caractère</em>.
On expliquera ce comportement plus en détail dans la section <a href="#boolean">manipuler des booléens</a>.</p>
</div>
<div class="paragraph">
<p>L&#8217;instruction <code>if</code> peut être complétée avec l&#8217;instruction <code>else</code>
pour exécuter du code qui répondrait au cas contraire.
On peut imbriquer plusieurs <code>else if</code> à la suite.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">instructions/else-if.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const book = {
  title: 'Node.js',
  published: true
};

if (book.published &amp;&amp; book.title) {
  console.log('Le livre est publié avec un titre.');
}
else if (book.published) {
  console.log('Le livre est publié (sans titre).');
}
else {
  console.log('Le livre n\'est pas publié.');
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notre exemple n&#8217;empruntera qu&#8217;un seul des chemins, mais on peut
constater qu&#8217;on pourrait en emprunter un autre
en modifiant la valeur des clés <code>title</code> et <code>published</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="scope">2.3. Portée (<em>scope</em>)</h3>
<div class="paragraph">
<p>La <em>portée</em> est un concept très présent dans ECMAScript.
On y fait souvent référence en parlant de <em>variable globale</em> et
de <em>variable locale</em>.
On peut y sentir une notion de frontière d&#8217;accès à la valeur
d&#8217;une variable.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">scopes/local.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function secret(){
  const mot = 'devinette';

  return 'None shall pass';
}

console.log(secret());
console.log(mot);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ce que nous dit l&#8217;exemple précédent,
c&#8217;est que la variable <code>secret</code> de type fonction a une portée globale
au script en question.
Qu&#8217;en-est-il de la variable <code>mot</code> encapsulée dans cette fonction ?</p>
</div>
<div class="paragraph">
<p>On pourrait le résumer ainsi :
la variable <code>mot</code> est définie dans la fonction <code>secret</code>
et n&#8217;est donc pas accessible en dehors de la portée de la fonction.
À l&#8217;inverse, ce qui est défini <em>en dehors</em> d&#8217;une fonction
est accessible <em>à l&#8217;intérieur</em> d&#8217;une fonction.</p>
</div>
<div class="paragraph">
<p>La portée de la variable <code>mot</code> est locale à la fonction <code>secret</code>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">scopes/global.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const year = 2018;

function next(value) {
  return value + 1;
}

function nextYear() {
  return next(year);
}

console.log(year);
console.log(nextYear());
console.log(value);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dans le précédent exemple, nous illustrons la portée globale de la variable
<code>year</code>.
Elle est définie un cran au-dessus des fonctions <code>next</code> et <code>nextYear</code>.
On peut y accéder, comme en atteste le code de la fonction <code>nextYear</code>.</p>
</div>
<div class="paragraph">
<p>À l&#8217;inverse, la variable <code>value</code> a une portée locale
— elle est passée en paramètre de la fonction <code>next</code>.
ECMAScript génèrera une erreur si on tente
d&#8217;y accéder en dehors de sa portée.</p>
</div>
<div class="paragraph">
<p><strong>La portée est délimitée par les fonctions</strong>.
En l&#8217;absence de fonction, la portée maximale est celle du module (script) dans lequel la variable est déclarée.</p>
</div>
<div class="paragraph">
<p>Il existe un deuxième type de portée : la <em>portée lexicale</em>.
L&#8217;exemple suivant servira à illustrer la nature de sa délimitation.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">scopes/lexical.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const book = {
  title: 'Node.js',
  published: true
};

if (book.published) {
  const price = 32;

  console.log(`Le livre ${book.title} coûte ${price}€.`);
}

console.log(`Le livre ${book.title} coûte ${price}€.`);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le mot-clé <code>const</code> crée une variable certes,
mais une variable dont la portée est <em>lexicale</em>.
<strong>La portée lexicale est délimitée par le bloc d&#8217;instructions</strong>
dans lequel la variable est déclarée.</p>
</div>
<div class="paragraph">
<p>Ainsi la variable <code>price</code> n&#8217;existe que dans le cadre du bloc <code>if</code>.</p>
</div>
<div class="paragraph">
<p>L&#8217;utilisation de la portée lexicale sert déclarer
des variables sans <em>polluer</em> le reste du script,
pour que son existence soit oubliée aussitôt le bloc exécuté.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="string">3. Manipuler du texte</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Il est commun d&#8217;avoir à manipuler des chaînes de caractères.
Pour stocker des URL, des titres, des identifiants,
des tweets voire des textes longs.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">// Utilisation de guillemets simples
console.log('L\'après-midi\nLe soir');  <b class="conum">(1)</b>

// Utilisation de guillemets doubles
console.log('L\'après-midi\nLe soir');   <b class="conum">(2)</b>

// Utilisation de guillemets obliques
console.log(`L'après-midi
Le soir`);                              <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Utilisation de guillemets simples (<code>\n</code> permet de revenir à la ligne) ;</p>
</li>
<li>
<p>Utilisation de guillemets doubles — évite d&#8217;échapper le guillemet simple ;</p>
</li>
<li>
<p>Utilisation de guillemets obliques — autorise le multi-ligne.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On peut utiliser n&#8217;importe quel caractère : lettres, chiffres,
caractères accentués, émojis et même des sinogrammes ou des kanjis.
Autrement dit, il n&#8217;y a pas de limite.
Les environnements d&#8217;exécution se représentent les caractères au format
UTF-16 (tables de stockage Unicode sur 16 bits de données).</p>
</div>
<div class="paragraph">
<p>Il est fréquent d&#8217;avoir à <em>concaténer</em> des chaînes de caractères,
ou à les composer à partir d&#8217;une autre variable.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/concat.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const mot = 'pot';

console.log(`${mot} de colle`);
console.log(`${mot} de fleur`);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Toute chaîne de caractères offre un ensemble
d'<em>attributs</em> (<code>.quelque-chose</code>)
et de <em>méthodes</em> (<code>.autre-chose()</code>) pour en savoir plus
sur la chaine mais aussi pour la manipuler.</p>
</div>
<div class="paragraph">
<p>Par exemple, on peut connaître la longueur d&#8217;une chaîne via son attribut <code>length</code>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/length.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log('I ♥ JavaScript'.length); <b class="conum">(1)</b>
console.log(''.length);               <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>14</code> ;</p>
</li>
<li>
<p>Affiche <code>0</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On peut aussi accéder à un caractère spécifique en utilisant
la chaîne comme un tableau, ou en utilisant une méthode dédiée :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/char-at.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const mot = 'Node.js';

console.log(mot[0]);        <b class="conum">(1)</b>
console.log(mot.charAt(1)); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>N</code> ;</p>
</li>
<li>
<p>Affiche <code>o</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Deux autres fonctions transforment
un texte en lettres minuscules et majuscules :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/lower-upper-case.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const mot = 'Node.js';

console.log(mot.toLocaleLowerCase()); <b class="conum">(1)</b>
console.log(mot.toLocaleUpperCase()); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>node.js</code> ;</p>
</li>
<li>
<p>Affiche <code>NODE.JS</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>D&#8217;autres fonctions nettoient ou complètent les espaces autour,
au début ou à la fin d&#8217;une chaîne de caractères :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/trim-pad.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const mot = '  Node.js  ';

console.log(mot.trim());      <b class="conum">(1)</b>
console.log(mot.trimLeft());  <b class="conum">(2)</b>
console.log(mot.trimRight()); <b class="conum">(3)</b>

const swiftCode = 'BARCGB22';

console.log(swiftCode.padEnd(11, 'X')); <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>Node.js</code> ;</p>
</li>
<li>
<p>Affiche <code>Node.js&#160;&#160;</code> ;</p>
</li>
<li>
<p>Affiche <code>&#160;&#160;Node.js</code> ;</p>
</li>
<li>
<p>Affiche <code>BARCGB22XXX</code> ;</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Dans cet exemple, la méthode <code>padEnd</code> complète jusqu&#8217;à <code>11</code> caractères,
avec le caractère <code>X</code>.
La méthode <code>padStart</code> fait la même chose mais avec le début de la chaîne.</p>
</div>
<div class="paragraph">
<p><code>indexOf</code> retourne la position de la <em>première occurrence</em>
dans une chaîne.
Si la valeur n&#8217;est pas trouvée, elle renvoie la valeur <code>-1</code>.
À l&#8217;inverse, <code>lastIndexOf</code> retournera la dernière occurrence trouvée :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">string/index-of.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log('I ♥ JavaScript'.indexOf('JavaScript')); <b class="conum">(1)</b>
console.log('I ♥ JavaScript'.indexOf('?'));          <b class="conum">(2)</b>
console.log('I ♥ JavaScript'.indexOf('a'));          <b class="conum">(3)</b>
console.log('I ♥ JavaScript'.lastIndexOf('a'));      <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Retourne <code>4</code> ;</p>
</li>
<li>
<p>Retourne <code>-1</code> — aucune occurrence n&#8217;ayant été trouvée ;</p>
</li>
<li>
<p>Retourne <code>5</code> — première occurrence de la lettre <code>a</code> ;</p>
</li>
<li>
<p>Retourne <code>7</code> — dernière occurrence de la lettre <code>a</code>.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="regexp">3.1. Expressions régulières (<em>RegExp</em>)</h3>
<div class="paragraph">
<p>Si <code>indexOf</code> et <code>lastIndexOf</code> identifient des caractères exacts,
comment faire lorsque l&#8217;on souhaite chercher de manière approximative,
plusieurs fois et selon certaines conditions ?</p>
</div>
<div class="paragraph">
<p>Les <em>expressions régulières</em> (<em>RegExp</em>, pour <em>Regular Expressions</em>)
entrent en jeu dans ces cas plus avancés.
Leur mécanisme décrit des <em>motifs</em> à identifier.
Plusieurs <em>méthodes</em> servent ensuite à tester, identifier et remplacer
ces motifs au sein d&#8217;une chaîne de caractères.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">💡</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Anecdote</span> RegExp et Perl</div>
<div class="paragraph">
<p>La syntaxe d&#8217;expressions régulières est inspirée de celle du langage
de programmation <em>Perl</em> (<span class="URL"><a href="https://www.perl.org" class="bare">www.perl.org</a></span>) dans sa version 5.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Une expression régulière est décrite le plus souvent en tant que motif
encadré par les caractères <code>/</code> (<em>slash</em>), suffixé d'<em>options</em> exprimées sous forme de lettres :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">/[a-z]+.js/i</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cet exemple utilise l&#8217;option <code>i</code> mais il en existe plusieurs :</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
insensible à la casse (<code>i</code>)
</td>
<td class="hdlist2">
<p>On souhaite identifier du contenu, peu importe s&#8217;il est en majuscules ou non ;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
multi-ligne (<code>m</code>)
</td>
<td class="hdlist2">
<p>La recherche s&#8217;effectue sur <em>toutes</em> les lignes ;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
global (<code>g</code>)
</td>
<td class="hdlist2">
<p>La recherche identifie <em>tous</em> les résultats
— au lieu d&#8217;un seul et le premier ;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
unicode (<code>u</code>)
</td>
<td class="hdlist2">
<p>À utiliser si le motif de recherche exprime des séquences de caractères
Unicode sous la forme <code>\u{&#8230;&#8203;.}</code> (voir les <em>classes de caractères</em> ci-après).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Illustrons leur utilisation en <em>identifiant du texte</em> répondant (<code>match</code>)
à une <em>expression régulière</em> (<code>/&#8230;&#8203;/</code>) :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/flags.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const text = 'I ♥ Node.js &amp; Anode';

console.log(text.match(/node/i));   <b class="conum">(1)</b>
console.log(text.match(/ode/g));    <b class="conum">(2)</b>
console.log(text.match(/node/ig));  <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>identifie et affiche <code>Node</code>, l&#8217;occurrence contenue dans le mot <code>Node.js</code> ;</p>
</li>
<li>
<p>affiche 2 fois <code>ode</code> — les occurrences contenues dans le mot <code>Node.js</code> et <code>Anode</code> ;</p>
</li>
<li>
<p>affiche <code>Node</code> et <code>node</code> en combinant les deux options <code>i</code> et <code>g</code> — les occurrences contenues dans le mot <code>Node.js</code> et <code>Anode</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Des éléments de syntaxe complètent les options pour
<strong>identifier des motifs</strong> au sein de chaînes de caractères :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ensemble de caractères (entre <code>[</code> et <code>]</code>)</dt>
<dd>
<p>Liste l&#8217;ensemble des caractères recherchés.
Le caractère <code>-</code> correspond à une plage de caractère.<br>
Exemple <code>[a-d]</code> correspond à <code>[abcd]</code>, donc <em>a</em> ou <em>b</em> ou <em>c</em> ou <em>d</em>) ;</p>
</dd>
<dt class="hdlist1">nombre de caractères (entre <code>{</code> et <code>}</code>)</dt>
<dd>
<p>Répète un caractère ou ensemble de caractères,
<em>exactement</em> (<code>{2}</code> — exactement 2)
<em>au moins</em> (<code>{2,}</code> — au moins 2)
ou <em>entre</em> (<code>{1,2}</code> — entre 1 et 2 fois) ;</p>
</dd>
<dt class="hdlist1">nombre de caractères (<code>?</code>, <code>+</code> et <code>*</code>)</dt>
<dd>
<p>Version raccourcie du nombre de caractères pour des besoins usuels :
<em>0 ou 1 caractère</em> avec <code>?</code>,
<em>1 caractère et plus</em> avec <code>+</code> et
<em>0 caractère et plus</em> avec <code>*</code>.</p>
</dd>
</dl>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/syntax.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const paris15 = '75015 Paris';
const avray = '92410 Ville-d\'Avray';

// test du code postal uniquement
console.log(paris15.match(/[0-9]{2}/));          <b class="conum">(1)</b>
console.log(paris15.match(/[0-9]{2,5}/));        <b class="conum">(2)</b>

// test du code postal et de la ville
console.log(paris15.match(/[0-9]{5} [a-zA-Z]+/)); <b class="conum">(3)</b>
console.log(paris15.match(/[0-9]{5} [a-z]+/i));   <b class="conum">(4)</b>

// test sur un nom de ville composé
console.log(avray.match(/[0-9]{5} [a-z]+/i));     <b class="conum">(5)</b>
console.log(avray.match(/[0-9]{5} [a-z'-]+/i));   <b class="conum">(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["75"]</code> — les 2 premiers caractères numériques de la chaîne ;</p>
</li>
<li>
<p>Affiche <code>["75015"]</code> – les 5 premiers caractères numériques (satisfait la condition <code>5</code> de <em>entre 2 et 5</em> de <code>{2,5}</code>) ;</p>
</li>
<li>
<p>Affiche <code>["75015 Paris"]</code> ;</p>
</li>
<li>
<p>Affiche <code>["75015 Paris"]</code> — l&#8217;option <code>i</code> nous permet de nous passer de l&#8217;ensemble <code>A-Z</code> ;</p>
</li>
<li>
<p>Affiche <code>["92410 Ville"]</code> — capture les caractères jusqu&#8217;à ce que la condition ne soit plus remplie en rencontrant le <em>trait d&#8217;union</em> (<code>-</code>) ;</p>
</li>
<li>
<p>Affiche <code>["92410 Ville-d&#8217;Avray"]</code> ;</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>D&#8217;autres opérateurs <strong>délimitent notre recherche</strong> :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">début et fin de chaîne (<code>^</code> et <code>$</code>)</dt>
<dd>
<p>Symbolise le début (<code>^</code>) ou la fin (<code>$</code>) d&#8217;une chaîne de caractères.<br>
Quand l&#8217;option multi-ligne (<code>m</code>) est utilisée, les notions de <em>début</em>
et de <em>fin</em> s&#8217;appliquent au niveau de la <em>ligne</em> ;</p>
</dd>
<dt class="hdlist1">limite de mot (<code>\b</code>)</dt>
<dd>
<p>Symbolise tout caractère ne faisant pas partie d&#8217;un mot, y compris le début ou la fin d&#8217;une chaîne ;</p>
</dd>
<dt class="hdlist1">ou (<code>|</code>)</dt>
<dd>
<p>Sépare deux choix l&#8217;un de l&#8217;autre.
Exemple : <code>/noir|blanc/</code> ;</p>
</dd>
<dt class="hdlist1">groupe de capture (entre <code>(</code> et <code>)</code>)</dt>
<dd>
<p>Délimite un groupe de caractères.
Les groupes peuvent par la suite être <em>identifiés</em> et <em>remplacés</em>.<br>
On notera également que l&#8217;emploi des <em>groupes</em> change
la structure des résultats en un tableau de plusieurs éléments.
Ce tableau a la forme <code>["chaine identifiée", "groupe 1", "groupe 2" &#8230;&#8203;]</code>.</p>
</dd>
</dl>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/limits.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const postcode = '75015 Paris';
const cedex = `CODEPOSTAL VILLE CEDEX
33900 Bordeaux Cedex 9
33074 BORDEAUX CEDEX
33700 MERIGNAC Cidex 40`;

const nogroup = /^[0-9]{5} [a-z0-9' -]+/i;
const group = /^([0-9]{5}) [a-z0-9' -]+/i;

// avec ou sans groupe de capture
console.log(postcode.match(nogroup));         <b class="conum">(1)</b>
console.log(postcode.match(group));           <b class="conum">(2)</b>

// mode multiligne avec ou sans option globale
console.log(cedex.match(/^([0-9]{5})/im));    <b class="conum">(3)</b>
console.log(cedex.match(/^([0-9]{5})/gim));   <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["75015 Paris"]</code> ;</p>
</li>
<li>
<p>Affiche <code>["75015 Paris", "75015"]</code>
— le premier élément correspond à la chaîne identifiée tandis que
le second élément correspond au <em>premier</em> groupe de capture ;</p>
</li>
<li>
<p>Affiche <code>["33900", "33900"]</code>
– l&#8217;option multi-ligne itère de ligne en ligne jusqu&#8217;à trouver un motif ;</p>
</li>
<li>
<p>Affiche <code>["33900", "33074", "33700"]</code>
— l&#8217;option multi-ligne globale retourne tous les groupes de capture.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On notera qu&#8217;il faut faire attention à ce que l&#8217;on regarde dans les résultats :
le format de résultat varie selon qu&#8217;on utilise ou non des groupes de capture,
selon qu&#8217;on utilise l&#8217;option globale ou non,
selon qu&#8217;on utilise l&#8217;option multi-ligne ou non…</p>
</div>
<div class="paragraph">
<p>Des classes de caractère servent de raccourcis pour désigner
plusieurs caractères à la fois :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">tout caractère (<code>.</code>)</dt>
<dd>
<p>Équivalent à <em>tout caractère</em>… sauf le saut de ligne ;</p>
</dd>
<dt class="hdlist1">caractère de mot (<code>\w</code>)</dt>
<dd>
<p>Équivalent à tout caractère pouvant composer un mot… anglais.
Les caractères accentués ne comptent pas malheureusement…
Identique à <code>[A-Za-z0-9_]</code></p>
</dd>
<dt class="hdlist1">caractère numérique (<code>\d</code>)</dt>
<dd>
<p>Équivalent à tout caractère numérique.
Identique à <code>[0-9]</code>.</p>
</dd>
<dt class="hdlist1">caractère d&#8217;espacement (<code>\s</code>)</dt>
<dd>
<p>Équivalent à tout caractère d&#8217;espacement
(espace, tabulation, retour chariot, etc.) ;</p>
</dd>
<dt class="hdlist1">caractère Unicode (<code>\u{&#8230;&#8203;.}</code>)</dt>
<dd>
<p>Doit être combiné avec l&#8217;option <code>u</code> (<code>/&#8230;&#8203;/u</code>).
Exemple : ♥︎ &#8594; <code>\u{2665}</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Les alternatives de classes en majuscules sont des <em>négations</em>.
<code>\W</code> pour "tout sauf un caractère de mot", <code>\S</code> pour "tout sauf un caractère d&#8217;espacement", etc.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/classes.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const text = 'I ♥ RegExp in 2018';

console.log(text.match(/\u{2665} (\w+)/u));     // <1>

const [,iLove,year] = text.match(/^(I \u{2665}).+(\d{4})$/u);

console.log(`${iLove} ${year}`);                // <2></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["♥ RegExp", "RegExp"]</code>
— et s&#8217;arrête là car l&#8217;espace suivant n&#8217;est pas un caractère de mot ;</p>
</li>
<li>
<p>Affiche <code>"I ♥ 2018"</code>
— on a extrait le début de la phrase et l&#8217;année placée en fin de chaîne.</p>
</li>
</ol>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> expressions régulières</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur expressions régulières.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/RegExp" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/RegExp</a>

</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>La méthode <code>test</code> est pratique si la seule qui vous intéresse
est de tester si une chaîne correspond à un motif :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/test.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const cedex = `CODEPOSTAL VILLE CEDEX
33900 Bordeaux Cedex 9
33074 BORDEAUX CEDEX
33700 MERIGNAC Cidex 40`;

const postcode_tester = /^\d{5}\s/m;

if (postcode_tester.test(cedex)) {
  console.log(cedex.match(/^(\d{5})\b/gm));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enfin, la méthode <code>replace</code> est très utile pour transformer des chaînes de
caractères, surtout en combinaison avec les groupes de capture :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/replace.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const text = 'I ♥ JavaScript';


console.log(text.replace('♥', 'love'));     <b class="conum">(1)</b>
console.log(text.replace(/\b\w+$/, 'PHP')); <b class="conum">(2)</b>

console.log(text.replace(/^.+(\u{2665}) (\w+)$/u, '$2 $1 me')); <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"I love JavaScript"</code>
— si le premier argument de <code>replace</code> est une chaîne,
elle est convertie automatiquement en expression régulière ;</p>
</li>
<li>
<p>Affiche <code>"I ♥ PHP"</code> ;</p>
</li>
<li>
<p>Affiche <code>JavaScript ♥ me"</code>
— les symboles <code>$&lt;numéro&gt;</code> représentent les groupes de capture ;
on peut les placer dans l&#8217;ordre de notre choix .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>D&#8217;ailleurs le second argument accepte une <a href="#functions">fonction</a>
pour procéder à des remplacements dynamiques :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">regexp/replace-function.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const text = 'I ♥ JavaScript';

const shout = text.replace(/\b(\w+)$/u, (pattern, lang) =&gt; {
  return lang.toLocaleUpperCase();
});

console.log(shout);   <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"I ♥ JAVASCRIPT"</code> — le dernier mot est transformé en majuscules.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="boolean">4. Manipuler des booléens</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Un booléen est une donnée de type logique qui peut être <em>vraie</em> ou <em>fausse</em> en prenant respectivement la valeur <code>true</code> ou <code>false</code>.
C&#8217;est un type de choix pour effectuer des <em>assertions</em> et vérifier des <em>conditions</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">boolean/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const counter = 3;

console.log(counter);               <b class="conum">(1)</b>
console.log(counter === 3);         <b class="conum">(2)</b>

const check = (counter === 3);

console.log(check);                 <b class="conum">(3)</b>
console.log(check === true);        <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>3</code> ;</p>
</li>
<li>
<p>Affiche <code>true</code> — la condition est vérifiée (3 équivaut strictement à 3) ;</p>
</li>
<li>
<p>Affiche <code>true</code> — c&#8217;est la valeur de la variable <code>check</code> suite à son assignation lors de la ligne précédente ;</p>
</li>
<li>
<p>Affiche <code>true</code> — la variable <code>check</code> équivaut strictement à <code>true</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Une donnée d&#8217;un autre type peut être convertie en booléen.
La logique qui déterminera si la conversion retournera <code>true</code> ou <code>false</code>
est la suivante :</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>true</code>
</td>
<td class="hdlist2">
<p>Toute valeur non-nulle.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>false</code>
</td>
<td class="hdlist2">
<p>Toute valeur nulle (<code>null</code>, <code>0</code>, <code>NaN</code>), vide (<code>''</code>)
ou indéfinie (<code>undefined</code>).</p>
</td>
</tr>
</table>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">boolean/convert.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const counter = 3;

console.log(Boolean(''));       <b class="conum">(1)</b>
console.log(Boolean(counter));  <b class="conum">(2)</b>
console.log(Boolean([]));       <b class="conum">(3)</b>

if (counter) {
  console.log('if (counter) équivaut à if (Boolean(counter))');
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>false</code> — il s&#8217;agit d&#8217;une <em>chaîne vide</em> ;</p>
</li>
<li>
<p>Affiche <code>true</code> - il s&#8217;agit d&#8217;une valeur <em>non-nulle</em> ;</p>
</li>
<li>
<p>Affiche <code>true</code> — le tableau est vide mais l&#8217;objet en lui-même <em>vaut</em> quelque chose : un tableau.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="number">5. Manipuler des nombres (<em>Number</em>, <em>Math</em>)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ECMAScript ne fait pas de distinction entre des nombres entiers et des
nombres contenant des décimales : ce sont des <em>nombres</em> un point c&#8217;est tout.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(40);
console.log(40.0);

console.log(40 === 40.0);   <b class="conum">(1)</b>
console.log(40 === '40.0'); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>true</code> — les deux valeurs sont strictement équivalentes ;</p>
</li>
<li>
<p>Affiche <code>false</code> — un élément entre guillemets est une chaîne de caractère.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Les nombres sont représentés par défaut en <em>base 10</em>.
La plage de nombre utilisable démarre à <em>moins l&#8217;infini</em> et va jusqu&#8217;à <em>plus l&#8217;infini</em>.
Des constantes définies par ECMAScript contiennent les valeurs minimales et
maximales que l&#8217;on peut représenter dans un programme :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/constants.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(Number.POSITIVE_INFINITY);  <b class="conum">(1)</b>
console.log(Number.NEGATIVE_INFINITY);  <b class="conum">(2)</b>

console.log(Number.MAX_VALUE);          <b class="conum">(3)</b>
console.log(Number.MIN_VALUE);          <b class="conum">(4)</b>

console.log(Number.MAX_SAFE_INTEGER);   <b class="conum">(5)</b>
console.log(Number.MIN_SAFE_INTEGER);   <b class="conum">(6)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>Il est aussi possible de compter dans d&#8217;autres bases comme la <em>base 16</em>,
c&#8217;est-à-dire une représentation hexadécimale de 0 à 16, exprimée de 0 à F
— A vaut 10 (car juste après 9), B vaut 11, etc.
Leur notation se fait en préfixant la valeur par <code>0x</code> :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/hexa.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(0x0000);
console.log(0x000A);
console.log(0x00A0);
console.log(0x0A00);</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>0</code> ;</p>
</li>
<li>
<p>Affiche <code>10</code> — car <code>A</code> en hexadécimal vaut 10 en décimal ;</p>
</li>
<li>
<p>Affiche <code>160</code> — pour <code>10 x 16</code> (une dizaine vaut 16) ;</p>
</li>
<li>
<p>Affiche <code>2560</code> — pour <code>10 x 16 x 16</code> (une centaine vaut 16x16).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">💬</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Rumeur</span> JavaScript est nul en virgule flottante !</div>
<div class="paragraph">
<p>ECMAScript est souvent décrié par son incapacité à gérer les opérations
mathématiques avec précision.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">0.2 + 0.6</code></pre>
</div>
</div>
<div class="paragraph">
<p>ECMAScript respecte le standard <em>IEEE 754</em> de gestion de nombres à virgule flottante sur 64 bits de données.
Qui d&#8217;autre l&#8217;utilise ?
D&#8217;autres langages "inconnus" comme Python, PHP et Ruby, entre autres.</p>
</div>
<div class="paragraph">
<p>Pour en savoir plus : <span class="URL"><a href="https://fr.wikipedia.org/wiki/IEEE_754" class="bare">fr.wikipedia.org/wiki/IEEE_754</a></span>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="opérations_mathématiques">5.1. Opérations mathématiques</h3>
<div class="paragraph">
<p>Les nombres s&#8217;utilisent pour effectuer des opérations mathématiques.
Chaque opération est dotée d&#8217;un symbole :</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
addition
</td>
<td class="hdlist2">
<p><code>+</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
soustraction
</td>
<td class="hdlist2">
<p><code>-</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
multiplication
</td>
<td class="hdlist2">
<p><code>*</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
division
</td>
<td class="hdlist2">
<p><code>/</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
modulo (reste de division)
</td>
<td class="hdlist2">
<p><code>%</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
exposant (puissance)
</td>
<td class="hdlist2">
<p><code>**</code></p>
</td>
</tr>
</table>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/operations.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(2 + 4);
console.log(2 - 4);
console.log(2 * 4);
console.log(2 / 4);
console.log(2 % 4);
console.log(2 ** 4);</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>6</code> ;</p>
</li>
<li>
<p>Affiche <code>-2</code> ;</p>
</li>
<li>
<p>Affiche <code>8</code> ;</p>
</li>
<li>
<p>Affiche <code>0.5</code> ;</p>
</li>
<li>
<p>Affiche <code>2</code> ;</p>
</li>
<li>
<p>Affiche <code>16</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">⚠️</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Attention</span> Opérations exotiques</div>
<div class="paragraph">
<p>Est-ce que vous avez déjà tenté d&#8217;additionner un nombre avec un tableau ?
Pas forcément… mais ECMAScript ne vous en empêchera pas.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/operations-types.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(10 / '1');    <b class="conum">(1)</b>
console.log(10 / 0);      <b class="conum">(2)</b>
console.log(10 / []);
console.log(10 / {});     <b class="conum">(3)</b>
console.log(10 + null);
console.log(10 + true);</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>La chaîne <code>'1'</code> sera convertie en nombre (voir section ci-après)…
donc <em>ça marche</em> !</p>
</li>
<li>
<p>On nous a toujours interdit la division par zéro ?
En vrai on crée l'<em>infini</em> ;</p>
</li>
<li>
<p>Seule cette opération retournera… autre chose qu&#8217;un nombre.
Rendez-vous à la section suivante pour se prémunir
des nombres qui n&#8217;en sont pas.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Moralité : <strong>s&#8217;assurer de ne manipuler que des nombres</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="les_nombres_qui_n_en_sont_pas_em_nan_em">5.2. Les nombres qui n&#8217;en sont pas (<em>NaN</em>)</h3>
<div class="paragraph">
<p>Certaines opérations n&#8217;aboutiront pas… sans afficher d&#8217;erreur pour autant.
Dans ce cas, le résultat de l&#8217;opération vaudra… <code>NaN</code>.
Pour <em>not a number</em> (littéralement : "n&#8217;est pas un nombre").</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/nan.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(10 / 'fromage');</code></pre>
</div>
</div>
<div class="paragraph">
<p>La fonction <code>Number.isNaN</code> nous aidera à vérifier si la valeur d&#8217;une variable
ou le résultat d&#8217;une opération est un <code>NaN</code> ou non.
Cette fonction retourne un <a href="#boolean">booléen</a>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/is-nan.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(Number.isNaN(NaN));             <b class="conum">(1)</b>
console.log(Number.isNaN(10 / 'fromage'));  <b class="conum">(2)</b>

console.log(Number.isNaN(10));              <b class="conum">(3)</b>
console.log(Number.isNaN('fromage'));       <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">🚨</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Assertion</span> NaN n&#8217;est pas un nombre… vraiment ?</div>
<div class="paragraph">
<p>Il faut se méfier de <code>NaN</code> comme de la peste.
Si on vérifie seulement le type de valeur pour s&#8217;assurer que tout va bien,
on ne se rendra pas compte que <code>NaN</code> est considéré… comme un nombre :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/nan-number.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(typeof NaN);
console.log(typeof 10);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Il vaudra mieux s&#8217;assurer qu&#8217;une variable est
un nombre <em>et</em> n&#8217;est pas un <code>NaN</code> :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/is-not-a-nan.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const result = 10 / 'fromage';

if (typeof result === 'number' &amp;&amp; !Number.isNaN(result)) {
  console.log('Ceci n\'est pas un NaN.');
}
else {
  console.log('L\'opération produit un nombre qui n\'en est pas un.');
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="convertir_en_nombre">5.3. Convertir en nombre</h3>
<div class="paragraph">
<p>Les lignes qui précédent l&#8217;évoquent un peu : on peut passer d&#8217;autres types
de données à des nombres.
Idéalement, on voudra transformer explicitement quelque chose en un nombre.</p>
</div>
<div class="paragraph">
<p>Pour cela nous avons deux fonctions à disposition :</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>parseInt</code>
</td>
<td class="hdlist2">
<p>Essaie d&#8217;interpréter un nombre entier ;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>parseFloat</code>
</td>
<td class="hdlist2">
<p>Essaie d&#8217;interpréter un nombre à virgule.
La fonction s&#8217;arrête dès qu&#8217;elle n&#8217;a plus affaire à un chiffre.</p>
</td>
</tr>
</table>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/parse.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(parseInt('3.141592653589793'));   <b class="conum">(1)</b>
console.log(parseFloat('3.141592653589793')); <b class="conum">(2)</b>

console.log(parseInt('14.10-patch.2'));   <b class="conum">(3)</b>
console.log(parseFloat('14.10-patch.2')); <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>3</code> ;</p>
</li>
<li>
<p>Affiche <code>3.141592653589793</code> ;</p>
</li>
<li>
<p>Affiche <code>14</code> — ça ne change rien pour <code>parseInt</code> ;</p>
</li>
<li>
<p>Affiche <code>14.1</code> — la fonction s&#8217;arrête à la décimale précédant une lettre.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>parseInt</code> a cette particularité que l&#8217;on peut choisir la base
de la conversion avec le second argument de la fonction :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/parse-int.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(parseInt(10, 16));    <b class="conum">(1)</b>
console.log(parseInt('A', 16));   <b class="conum">(2)</b>
console.log(parseInt('A00', 16)); <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>16</code> ;</p>
</li>
<li>
<p>Affiche <code>10</code> — <code>A</code> étant juste après <code>10</code> en hexadécimal ;</p>
</li>
<li>
<p>Affiche <code>2560</code> — aurait pu s&#8217;écrire <code>0xF00</code>
(cf. le <a href="#number">début de cette même section</a>, à propos des bases).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="formater_et_arrondir_des_nombres">5.4. Formater et arrondir des nombres</h3>
<div class="paragraph">
<p>Si l&#8217;envie vous prenait de vouloir arrondir des nombres, il existe
quelques fonctions pour nous aider.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>Math.round</code>
</td>
<td class="hdlist2">
<p>Arrondit à l&#8217;entier le plus proche ;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Math.ceil</code>
</td>
<td class="hdlist2">
<p>Arrondit à l&#8217;entier supérieur du nombre donné ;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Math.floor</code>
</td>
<td class="hdlist2">
<p>Arrondit à l&#8217;entier inférieur du nombre donné.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Math.ceil, Math.floor</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/round.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(Math.round(3.1));    <b class="conum">(1)</b>
console.log(Math.round(3.8));    <b class="conum">(2)</b>
console.log(Math.round(3.5));    <b class="conum">(3)</b>

console.log(Math.ceil(3.14));    <b class="conum">(4)</b>
console.log(Math.floor(3.99));   <b class="conum">(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>3</code> — l&#8217;entier le plus proche est 3 ;</p>
</li>
<li>
<p>Affiche <code>4</code> — l&#8217;entier le plus proche est 4 ;</p>
</li>
<li>
<p>Affiche <code>4</code> — idem ;</p>
</li>
<li>
<p>Affiche <code>4</code> ;</p>
</li>
<li>
<p>Affiche <code>3</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Enfin, on peut préserver le formatage du nombre de décimales
après la virgule… en transformant le nombre <em>en chaîne de caractères</em>
grâce à la méthode <code>toFixed</code> :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">number/to-fixed.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(10.0101.toFixed(2));     <b class="conum">(1)</b>
console.log(10.0101.toFixed(0));     <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>'10.01'</code> ;</p>
</li>
<li>
<p>Affiche <code>'10'</code>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="functions">6. Manipuler des fonctions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une fonction est un mécanisme pour <strong>rendre du code réutilisable</strong>.
Une fonction <em>retourne</em> un résultat.
À l&#8217;aide de <em>paramètres</em>, on peut faire varier ce résultat.</p>
</div>
<div class="paragraph">
<p>Cela se passe en deux temps :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>la <em>création</em> de la fonction ;</p>
</li>
<li>
<p>l'<em>exécution</em> de la fonction.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ECMAScript fournit un ensemble de fonctions de base
(<code>console.log</code>, <code>setTimeout</code> etc).
Node ajoute les siennes (comme <code>require</code>).
Nous avons la liberté d&#8217;en créer nous-même, spécifiques à nos besoins.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">functions/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const hello = (mot) =&gt; `Hello ${mot}`;  <b class="conum">(1)</b>

console.log(hello);                     <b class="conum">(2)</b>
console.log(hello('World'));            <b class="conum">(3)</b>
console.log(hello('toi'));

const random = () =&gt; {
  const limit = 100;

  return Math.floor(Math.random() * limit);
};

console.log(random());                  <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>On <em>crée</em> la fonction <code>hello</code> ;</p>
</li>
<li>
<p>Affiche <code>[Function: hello]</code> — il s&#8217;agit de la définition de la fonction ;</p>
</li>
<li>
<p>Affiche <code>"Hello World"</code>
— il s&#8217;agit de l'<em>exécution</em> de la fonction, qui <em>retourne</em> un résultat ;</p>
</li>
<li>
<p>Affiche un nombre aléatoire entre 0 et 100
— cette fonction est invoquée sans paramètre.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent nous indique qu&#8217;une fonction se découpe en 3 parties :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">les <strong>arguments</strong></dt>
<dd>
<p>C&#8217;est la partie à gauche de la flèche (<code>&#8658;</code>).
Les arguments sont séparés par des virgules (exemple : <code>(argument1, argument2, etc.)</code>) ;</p>
</dd>
<dt class="hdlist1">le <strong>corps</strong></dt>
<dd>
<p>C&#8217;est la partie entre accolades (<code>{ &#8230;&#8203; }</code>).
Quand la fonction est sur une ligne,
le résultat de l&#8217;opération est <em>implicitement retourné</em>.
On peut dans ce cas se passer du mot-clé <code>return</code> ;</p>
</dd>
<dt class="hdlist1">la <strong>valeur de retour</strong></dt>
<dd>
<p>C&#8217;est la valeur renvoyée en dehors de la fonction.
La valeur de retour est définie à l&#8217;aide du mot-clé <code>return</code>.
La valeur <code>undefined</code> est retournée de manière implicite
lorsque le mot-clé <code>return</code> est absent.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">💡</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Rappelle-toi</span> Variables et portée</div>
<div class="paragraph">
<p>Le corps d&#8217;une fonction constitue une <em>portée</em> : toute variable définie
dans le corps d&#8217;une fonction est invisible en dehors.</p>
</div>
<div class="paragraph">
<p>On en parle plus en détails dans la <a href="#scope">section portée</a>
en début de section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="anonymous-function">6.1. Les fonctions anonymes</h3>
<div class="paragraph">
<p>Les fonctions anonymes sont employées en <strong>arguments d&#8217;autres fonctions</strong>.
On les dit <em>anonymes</em>, car elles ne sont pas consignées dans des <em>variables</em>.
Il est fréquent de les utiliser pour <em>itérer</em> sur des tableaux,
lors d&#8217;événements ou dans des <a href="#promise">promesses</a>.</p>
</div>
<div class="paragraph">
<p>C&#8217;est une manière élégante d&#8217;encapsuler du code à exécuter plus tard.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">functions/anonymous.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">setTimeout(() =&gt; console.log('Une seconde plus tard'), 1000);

setTimeout(() =&gt; {
  console.log('Deux secondes plus tard');     <b class="conum">(1)</b>
}, 2000);

process.on('exit', () =&gt; {
  console.log('Le processus se termine');     <b class="conum">(2)</b>
});</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"Deux secondes plus tard"</code> deux secondes après le début du script ;</p>
</li>
<li>
<p>Affiche <code>"Le processus se termine"</code> quand… le processus se termine
— une fois que toutes les actions en attente ont été exécutées.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="callback">6.2. Les fonctions de <em>callback</em></h3>
<div class="paragraph">
<p>Quand une fonction est passée en argument d&#8217;une autre fonction,
on appelle cela un <em>callback</em>.
On l&#8217;appelle plus tard (<em>to call back</em>) que le moment où elle est définie.
La fonction peut recevoir des paramètres qui aident à reconstruire un contexte
<em>au moment</em> de son exécution.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">functions/callback.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const printYear = (date) =&gt; {             <b class="conum">(2)</b>
  console.log(date.getUTCFullYear());     <b class="conum">(3)</b>
}

setTimeout(printYear, 1000, new Date());  <b class="conum">(1)</b>
// équivalent à
// setTimeout(date =&gt; printYear(date), 1000, new Date());</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Le troisième argument (et les suivants) de <code>setTimeout</code>
sont transmis en paramètre de la fonction de <em>callback</em> ;</p>
</li>
<li>
<p>Cette fonction sera invoquée une seconde après le début du script,
et recevra la date du moment en paramètre ;</p>
</li>
<li>
<p>Affiche l&#8217;année de la date passée en argument
— l&#8217;année en cours dans cet exemple.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="rest-parameters">6.3. Paramètres du reste (<em>rest parameters</em>)</h3>
<div class="paragraph">
<p>Les <em>paramètres du reste</em> collecte un nombre indéfini de paramètres.
Les paramètres sont <strong>regroupés dans un même <a href="#array">tableau</a></strong> (voir ci-après).</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">functions/rest.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const combien_de = (nom, ...params) =&gt; {
  console.log(`On a compté ${params.length} ${nom}.`);
};

combien_de('patates', 'un', 'deux', 'trois'); <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"On a compté 3 patates."</code>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="array">7. Manipuler des tableaux (<em>Array</em>)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les tableaux (ou listes indexées) servent à <strong>lister des éléments</strong>,
de tout type et dans l&#8217;ordre de notre choix.
Chaque élément de tableau se voit attribué un numéro (<em>index</em>).
On peut retrouver l&#8217;élément par son numéro, en itérant à l&#8217;aide de boucles
ou en ayant recours à d&#8217;autres méthodes d&#8217;identification.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const weekdays = ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi'];

console.log(weekdays);          <b class="conum">(1)</b>
console.log(weekdays.length);   <b class="conum">(2)</b>
console.log(weekdays[1]);       <b class="conum">(3)</b>
console.log(weekdays[0]);
console.log(weekdays[5]);       <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["lundi", "mardi", "mercredi", "jeudi", "vendredi"]</code> ;</p>
</li>
<li>
<p>Affiche <code>5</code> — soit la longueur du tableau ;</p>
</li>
<li>
<p>Affiche <code>"mardi"</code> — c&#8217;est l&#8217;élément défini à l&#8217;index <code>1</code> ;</p>
</li>
<li>
<p>Affiche <code>undefined</code> — il n&#8217;y a aucun élément défini à l&#8217;index <code>5</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent illustre plusieurs caractéristiques des collections :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>la numérotation débute à l&#8217;index <code>0</code> ;</p>
</li>
<li>
<p>la propriété <code>length</code> contient la longueur du tableau ;</p>
</li>
<li>
<p>la valeur <code>undefined</code> est retournée quand on tente d&#8217;accéder à un index
qui n&#8217;existe pas.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="créer_des_tableaux_à_partir_d_autres_valeurs">7.1. Créer des tableaux à partir d&#8217;autres valeurs</h3>
<div class="paragraph">
<p>La fonction <code>Array.from</code> est une manière de créer
un tableau à partir de quelque chose qui <em>ressemble à un tableau</em>.</p>
</div>
<div id="array.from" class="listingblock interactive interactive--javascript">
<div class="title">array/from.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">console.log(Array.from('fromage'));                                   <b class="conum">(1)</b>

// utilisation du second argument
console.log(Array.from('fromage', (letter) =&gt; letter.toUpperCase())); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["f", "r", "o", "m", "a", "g", "e"]</code>
— chaque lettre de la chaîne</p>
</li>
<li>
<p>Affiche <code>["F", "R", "O", "M", "A", "G", "E"]</code>
— chaque lettre de la chaîne a été passée en majuscules.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Le deuxième argument de <code>Array.from</code> est facultatif.
C&#8217;est une <a href="#anonymous-function">fonction anonyme</a> qui s&#8217;utilise comme les <a href="#array.forEach">méthodes d&#8217;itération</a> <code>Array.forEach</code> et <code>Array.map</code>.</p>
</div>
<div class="paragraph">
<p>Cette méthode est des plus utiles pour itérer sur des listes d&#8217;éléments DOM
obtenues avec les fonctions <code>document.querySelectorAll</code>
et <code>document.getElementsByTagName</code>, entre autres.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const links = document.querySelectorAll('a');

console.log(Array.from(links).map(a =&gt; a.textContent));
// parce qu'on ne peut pas faire
// links.map(a =&gt; a.textContent);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="array.concat">7.2. Combiner des tableaux</h3>
<div class="paragraph">
<p>Il est relativement aisé de composer des tableaux en fonction d&#8217;autres tableaux.
Une première manière d&#8217;y parvenir est d&#8217;utiliser la méthode <code>concat</code> :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/concat.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const mousquetaires = ['Atos', 'Portos', 'Aramis'];
const extras = ['d\'Artagnan', 'Albert'];

console.log(mousquetaires.concat(extras));      <b class="conum">(1)</b>

// autre manière d'obtenir la liste des 5 mousquetaires
console.log([].concat(mousquetaires, extras));</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["Atos", "Portos", "Aramis", "d&#8217;Artagnan", "Albert"]</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Cette méthode <em>crée un nouveau tableau</em> à partir d&#8217;une liste de tableaux
passés en paramètre.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">💬</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Alternative</span> Opérateur <code>&#8230;&#8203;</code> (<em>spread</em>)</div>
<div class="paragraph">
<p>Une autre manière de faire est d&#8217;utiliser l&#8217;opérateur <code>&#8230;&#8203;</code>
(aussi appelé <a href="#spread">spread</a>) pour éclater plusieurs tableaux et
les rassembler dans un autre :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/spread.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const mousquetaires = ['Atos', 'Portos', 'Aramis'];
const extras = ['d\'Artagnan', 'Albert'];

console.log([...mousquetaires, ...extras]);   <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["Atos", "Portos", "Aramis", "d&#8217;Artagnan", "Albert"]</code>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>À l&#8217;inverse, la méthode <code>join</code> <em>concatène</em> tous les éléments
dans une <a href="#string">chaîne de caractères</a> avec le séparateur de notre choix.
Ce séparateur est optionnel.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/join.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const headers = ['ID', 'NOM', 'PRENOM'];

console.log(headers.join());    <b class="conum">(1)</b>
console.log(headers.join(';')); <b class="conum">(2)</b>
console.log(headers.join(''));  <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"ID,NOM,PRENOM"</code>
— le séparateur par défaut est une virgule (<code>,</code>)</p>
</li>
<li>
<p>Affiche <code>"ID;NOM;PRENOM"</code>
— on a choisi le séparateur <code>;</code></p>
</li>
<li>
<p>Affiche <code>"IDNOMPRENOM"</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="array.forEach">7.3. Itérer sur les valeurs avec des boucles</h3>
<div class="paragraph">
<p>Les boucles sont une manière de <strong>parcourir plusieurs valeurs</strong>.
Elles aident la mise en place d&#8217;automatismes pour éviter de répéter du code.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/loop.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const weekdays = ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi'];

for (const day of weekdays) {
  console.log(day);                           <b class="conum">(1)</b>
}

// on obtient le même résultat avec la méthode `forEach`
weekdays.forEach((day) =&gt; console.log(day));</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche successivement chaque valeur du tableau
— <code>"lundi"</code>, <code>"mardi"</code>, <code>"mercredi"</code>, <code>"jeudi"</code>, <code>"vendredi"</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Prenons le temps de revenir sur cet exemple.
On y découvre plusieurs manières de faire des boucles sur un tableau :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>for&#8230;&#8203;of</code></dt>
<dd>
<p>On assigne une variable pour chaque élément (opérateur <code>of</code>) du tableau.
Les expressions situées entre accolade (<code>{&#8230;&#8203;}</code>) sont exécutées pour
chaque élément du tableau.</p>
</dd>
<dt class="hdlist1"><code>forEach(element &#8658; expression)</code></dt>
<dd>
<p>La méthode <code>forEach</code> applique une <a href="#anonymous-function">fonction anonyme</a>
pour chaque élément du tableau.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Il y a en réalité deux manières d&#8217;itérer avec la boucle <code>for</code> :
sur les <em>index</em> (avec l&#8217;opérateur <code>in</code>)
et sur les <em>valeurs</em> (avec l&#8217;opérateur <code>of</code>).</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/for-of-in.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const weekend = ['samedi', 'dimanche'];

for (const index in weekend) {
  console.log(index);             <b class="conum">(1)</b>
  console.log(weekend[index]);    <b class="conum">(2)</b>
}

for (const day in weekend) {
  console.log(day);               <b class="conum">(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche successivement <code>0</code> puis <code>1</code> ;</p>
</li>
<li>
<p>Affiche successivement <code>"samedi"</code> puis <code>"dimanche"</code>
— l&#8217;index permet de retrouver la valeur du tableau ;</p>
</li>
<li>
<p>Affiche successivement <code>"samedi"</code> puis <code>"dimanche"</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>La méthode <code>forEach</code> propage en réalité 3 arguments à notre fonction anonyme :
l'<strong>élément</strong> en cours de l&#8217;itération,
l'<strong>index</strong> de l&#8217;élément,
le <strong>tableau</strong> d&#8217;origine.</p>
</div>
<div class="paragraph">
<p>Pourquoi passer le tableau d&#8217;origine alors qu&#8217;on itère sur ce même tableau ?
Pour donner du contexte au cas où on opère
avec une <a href="#function">fonction nommée</a>.
Nous verrons un usage concret de ce troisième argument
dans la section <a href="#array.map">transformer les valeurs</a>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/foreach-function.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const undeux = ['un', 'deux'];

const printIndex = (element, index, array) =&gt; {
  console.log(`${element} se trouve à l'index ${index}`);  <b class="conum">(2)</b>
}

undeux.forEach(printIndex);                                <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Applique la fonction <code>printIndex</code> pour chaque élément du tableau <code>undeux</code></p>
</li>
<li>
<p>Affiche successivement <code>"un se trouve à l&#8217;index 0"</code> puis <code>"deux se trouve à l&#8217;index 1"</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Outre l&#8217;inspection et l&#8217;affichage des valeurs, les boucles offrent la liberté
de <a href="#array.sort">faire des tris</a>, de <a href="#array.map">transformer les valeurs</a>, de <a href="#array.filter">filtrer selon des conditions</a>
mais aussi de <a href="#array.reduce">créer de nouvelles structures de données</a>.</p>
</div>
<div class="paragraph">
<p>Ces méthodes sont décrites dans les sections suivantes.</p>
</div>
</div>
<div class="sect2">
<h3 id="array.sort">7.4. Trier les valeurs</h3>
<div class="paragraph">
<p>La méthode <code>sort</code> chaque l&#8217;ordre des éléments d&#8217;un tableau.
Cette méthode utilise une <a href="#anonymous-function">fonction anonyme</a>.
La fonction anonyme compare deux éléments entre eux.
Elle retourne un nombre positif, négatif ou égal à zéro selon la
logique que l&#8217;on souhaite donner au tri :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>quand la comparaison est <em>positive</em> :
<code>sort</code> placera le premier élément <em>avant</em> le second ;</p>
</li>
<li>
<p>quand la comparaison est <em>négative</em> :
<code>sort</code> placera le premier élément <em>après</em> le second ;</p>
</li>
<li>
<p>quand la comparaison est nulle ou non spécifiée :
l&#8217;ordre des éléments restera inchangé.</p>
</li>
</ul>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/sort.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const sortAsc = (a, b) =&gt; a - b;
const sortDesc = (a, b) =&gt; b - a;

console.log([1, 3, 2].sort(sortAsc));                   <b class="conum">(1)</b>

const undeux = [{label: 'deux', order: 2}, {label: 'un', order: 1}];

console.log(undeux.sort((a, b) =&gt; a.order - b.order));  <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>[1, 2, 3]</code> ;</p>
</li>
<li>
<p>Affiche <code>[ { label: "un", order: 1 }, { label: "deux", order: 2 } ]</code>
— le tableau a été trié sur la valeur de <code>order</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Les <a href="#string">chaînes de caractères</a> peuvent être comparées
avec la méthode <code>localeCompare</code>.
Cette méthode retourne un nombre après une comparaison caractère par caractère
entre deux chaînes :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/sort-strings.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const sortAlpha = (a, b) =&gt; a.localeCompare(b);

console.log(['A', 'b', 'c', 'a'].sort(sortAlpha));                  <b class="conum">(1)</b>

const undeux = [{label: 'un', order: 1}, {label: 'deux', order: 2}];

console.log(undeux.sort((a, b) =&gt; a.label.localeCompare(b.label))); <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["a", "A", "b", "c"]</code> — les majuscules influencent le tri ;</p>
</li>
<li>
<p>Affiche <code>[ { label: "deux", order: 2 }, { label: "un", order: 1 } ]</code>
— le tableau a été trié sur la valeur de <code>label</code> cette fois-ci.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">💡</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Alternative</span> <code>Array.reverse</code></div>
<div class="paragraph">
<p>La méthode <code>reverse</code> transforme le tableau d&#8217;origine
en inversant l&#8217;ordre de ses éléments.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/reverse.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const weekend = ['samedi', 'dimanche'];

weekend.reverse();

console.log(weekend);     <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["dimanche", "samedi"]</code>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="array.map">7.5. Transformer les valeurs</h3>
<div class="paragraph">
<p>La méthode <code>map</code> fonctionne quasiment comme la méthode <code>forEach</code>.
À ceci près qu&#8217;elle retourne un nouveau tableau,
constitué des valeurs retournées par la fonction appliquée sur chaque élément.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/map.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const newArray = ['a', ' b', 'c '].map(value =&gt; {
  return value.trim().toUpperCase();
});

console.log(newArray); <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Retourne <code>['A', 'B', 'C']</code>
— on a passé tous les éléments en lettres majuscules.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Le troisième argument de la méthode <code>map</code> prend ici tout son sens.
Par exemple si l&#8217;on souhaite dédoublonner un tableau :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/map-dedupe.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const soundcheck = ['un', 'deux', 'un', 'deux'];

const dedupe = (element, index, array) =&gt; {
  if (array.slice(index+1).includes(element)) {
    return null;
  }

  return element;
}

console.log(soundcheck.map(dedupe));          <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>[null, null, "un", "deux"]</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent vérifie à chaque itération si la valeur de l&#8217;élément
est contenue dans la <em>suite du tableau</em>.
<code>array.slice(index+1)</code> crée un nouveau tableau contenant tous les éléments
situés <em>après</em> l&#8217;élément courant (<code>index+1</code>).</p>
</div>
<div class="paragraph">
<p>La méthode <code>reduce</code> est une autre méthode de transformation.
Elle est différente, car elle passe le résultat de la précédente itération
à la suivante.
C&#8217;est comme si elle <em>accumulait</em> les résultats.
<code>reduce</code> retourne une valeur finale qui peut être autre chose qu&#8217;un tableau.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/reduce.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const stats = [2, 4, 6, 10];

const sum = (previous, element) =&gt; previous + element;    <b class="conum">(2)</b>

console.log(stats.reduce(sum, 0));    <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Effectue une <em>réduction</em> à l&#8217;aide de la fonction <code>sum</code> et d&#8217;une valeur
par défaut de <code>0</code>
— affiche <code>22</code> à l&#8217;issue des itérations ;</p>
</li>
<li>
<p>La valeur de l'<strong>élément</strong> est le <em>second paramètre</em> ;
le premier paramètre correspond au résultat de l&#8217;itération précédente…
ou de la valeur initiale, passée en argument à <code>reduce</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="array.filter">7.6. Filtrer les valeurs</h3>
<div class="paragraph">
<p>La méthode <code>filter</code> retourne un nouveau tableau filtré à l&#8217;aide
d&#8217;une <a href="#anonymous-function">fonction anonyme</a>.
Seuls les éléments qui satisfont la condition établie par la fonction
se retrouvent dans le nouveau tableau.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/filter.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const values = [null, 'un', 'deux', 3];

console.log(values.filter(value =&gt; Number.isFinite(value)));  <b class="conum">(1)</b>
console.log(values.filter(value =&gt; value));                   <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Retourne <code>[3]</code>
— c&#8217;est la seule valeur qui est un nombre</p>
</li>
<li>
<p>Retourne <code>["un", "deux", 3]</code>
— ce sont les valeurs non-nulles</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="array.find">7.7. Identifier une ou plusieurs valeurs</h3>
<div class="paragraph">
<p>Les méthodes <code>indexOf</code>, <code>lastIndexOf</code> et <code>includes</code> identifient une
<em>valeur exacte</em> au sein d&#8217;un tableau.</p>
</div>
<div class="paragraph">
<p><code>indexOf</code> et <code>lastIndexOf</code> retournent l'<em>index</em> de la valeur recherchée.
Si aucun élément n&#8217;a été retrouvé, elles retourneront la valeur <code>-1</code>.<br>
<code>includes</code> retourne un <a href="#boolean">booléen</a> indiquant si la recherche
est fructueuse (<code>true</code>) ou non (<code>false</code>).</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/index-of-includes.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const soundcheck = ['un', 'deux', 'un', 'deux'];

console.log(soundcheck.indexOf('un'));        <b class="conum">(1)</b>
console.log(soundcheck.indexOf('deux'));      <b class="conum">(2)</b>
console.log(soundcheck.indexOf('trois'));     <b class="conum">(3)</b>

console.log(soundcheck.lastIndexOf('deux'));  <b class="conum">(4)</b>

console.log(soundcheck.includes('deux'));     <b class="conum">(5)</b>
console.log(soundcheck.includes('trois'));    <b class="conum">(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>0</code> — le premier <code>"un"</code> est l&#8217;élément <code>0</code> du tableau</p>
</li>
<li>
<p>Affiche <code>1</code> – le premier <code>"deux"</code> est l&#8217;élément <code>1</code> du tableau</p>
</li>
<li>
<p>Affiche <code>-1</code> — cet élément est absent du tableau</p>
</li>
<li>
<p>Affiche <code>3</code> — le dernier <code>"deux"</code> est l&#8217;élément <code>3</code> du tableau</p>
</li>
<li>
<p>Affiche <code>true</code> — l&#8217;élément <code>"un"</code> existe dans le tableau</p>
</li>
<li>
<p>Affiche <code>false</code> — l&#8217;élément <code>"trois"</code> n&#8217;existe pas dnas le tableau</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Il existe ensuite d&#8217;autres méthodes comme <code>find</code>, <code>some</code> et <code>every</code>.
Elles <strong>identifient des éléments à partir d&#8217;une fonction</strong>.
Les conditions de recherche sont plus complètes, car on n&#8217;est pas obligé
de connaître la valeur exacte recherchée.</p>
</div>
<div class="paragraph">
<p>La méthode <code>find</code> retourne l'<em>élément</em> qui satisfait la condition en premier.
La méthode <code>findIndex</code> retourne l'<em>index de l&#8217;élément</em>
qui satisfait la condition en premier.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/find.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const values = [null, 2, 10, 100];

const biggerThan50 = (value) =&gt; value &gt; 50;   <b class="conum">(1)</b>

console.log(values.find(biggerThan50));       <b class="conum">(2)</b>
console.log(values.findIndex(biggerThan50));  <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>La fonction <code>isFinite</code> retourne <code>true</code>
si la valeur passée en argument est un nombre supérieur à <code>50</code></p>
</li>
<li>
<p>Affiche <code>100</code></p>
</li>
<li>
<p>Affiche <code>3</code> — c&#8217;est l&#8217;index de la valeur <code>100</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Les méthodes <code>some</code> et <code>every</code> retournent un <a href="#boolean">booléen</a>
lorsque la condition est satisfaite.
<code>some</code> retourne <code>true</code> si <em>au moins une itération</em> est satisfaisante.
<code>every</code> retourne <code>true</code> si <em>toutes les itérations</em> sont satisfaisantes.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/some.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const values = [1, 'a', 120, undefined, 4];
const isUndefined = (value) =&gt; value === undefined;

console.log(values.every(isUndefined));                <b class="conum">(1)</b>
console.log(values.some(isUndefined));                 <b class="conum">(2)</b>
console.log(values.filter(d =&gt; d).some(isUndefined));  <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>false</code> — toutes les valeurs ne sont pas égales à <code>undefined</code></p>
</li>
<li>
<p>Affiche <code>true</code> — au moins une valeur est égale à <code>undefined</code></p>
</li>
<li>
<p>Affiche <code>false</code> — il n&#8217;y a plus de valeur <code>undefined</code> dans le tableau,
car on a utilisé la méthode <a href="#array.filter">filter</a> pour supprimer les valeurs
non-vides</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="array-destructuring">7.8. Décomposition de tableau (<em>destructuring</em>)</h3>
<div class="paragraph">
<p>L&#8217;affectation par <em>décomposition</em> (<em>destructuring</em>) est une manière élégante
de piocher une ou plusieurs valeurs dans un <a href="#array">tableau</a>.
La décomposition n&#8217;altère pas le contenu des variables décomposées.
Ce mécanisme existe aussi pour les <a href="#object-destructuring">objets</a>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/destructuring.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const weekdays = ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi'];

const [first, second] = weekdays;
console.log(first);           <b class="conum">(1)</b>
console.log(second);          <b class="conum">(2)</b>

const [,, third] = weekdays;
console.log(third);           <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"lundi"</code></p>
</li>
<li>
<p>Affiche <code>"mardi"</code></p>
</li>
<li>
<p>Affiche <code>"mercredi"</code> — l&#8217;utilisation des virgules sans variable a permis
de <em>sauter</em> des positions dans la décomposition</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>La décomposition se combine agréablement avec l&#8217;opérateur <code>&#8230;&#8203;</code> (opérateur <em>spread</em>).
Il accumule <em>le reste</em> des éléments dans une variable, sous forme de tableau.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/destructuring-rest.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const weekdays = ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi'];

const [first, second, ...rest] = weekdays;
console.log(rest);           <b class="conum">(1)</b>

// revient au même que
// const [,, ...rest] = weekdays;</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["mercredi", "jeudi", "vendredi"]</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>La méthode <code>slice</code> offre davantage de souplesse pour gérer les <em>limites</em>.
On choisit <em>l&#8217;index de début</em> et <em>l&#8217;index de fin</em> de la décomposition.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/slice.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const values = ['un', 'deux', 'trois', 'quatre'];

console.log(values.slice(1));     <b class="conum">(1)</b>
console.log(values.slice(1, 2));  <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["deux", "trois", "quatre"]</code> — à partir de l&#8217;index <code>1</code></p>
</li>
<li>
<p>Affiche <code>["deux"]</code>
— à partir de l&#8217;index <code>1</code> et jusqu&#8217;à l&#8217;index <code>2</code> (non-inclus)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Si les valeurs de début et/ou de fin sont <em>négatives</em>,
les index sont calculés <em>à partir de la fin</em> du tableau.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">array/slice-negative.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const values = ['un', 'deux', 'trois', 'quatre'];

console.log(values.slice(-1));     <b class="conum">(1)</b>
console.log(values.slice(-3));     <b class="conum">(2)</b>

console.log(values.slice(0, -1));  <b class="conum">(3)</b>
console.log(values.slice(0, -3));  <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["quatre"]</code>
— premier élément à partir de la fin</p>
</li>
<li>
<p>Affiche <code>["deux", "trois", "quatre"]</code>
— les trois premiers éléments à partir de la fin</p>
</li>
<li>
<p>Affiche <code>["un", "deux", "trois"]</code>
— jusqu&#8217;au dernier élément à partir de la fin (non-inclus)</p>
</li>
<li>
<p>Affiche <code>["un"]</code>
— jusqu&#8217;au troisième élément à partir de la fin (non-inclus)</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="object">8. Manipuler des structures d&#8217;objet</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les structures d&#8217;objet servent à <strong>lister des éléments</strong> de tout type
au sein d&#8217;une même variable.
L&#8217;indexation se fait <em>comme dans un dictionnaire</em>,
avec un identifiant unique pour chaque valeur.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

console.log(francine.first_name); <b class="conum">(1)</b>

francine.age = 25;                <b class="conum">(2)</b>
console.log(francine.age);        <b class="conum">(3)</b>
console.log(francine.twitter);    <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"Francine"</code></p>
</li>
<li>
<p>On assigne une valeur numérique dans l&#8217;index <code>age</code> une fois l&#8217;objet créé</p>
</li>
<li>
<p>Affiche <code>25</code> — la valeur numérique précédemment assignée</p>
</li>
<li>
<p>Affiche <code>undefined</code> — aucune valeur n&#8217;est assignée pour cette clé</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Nous pouvons nous baser sur une autre syntaxe pour <em>créer</em> et <em>accéder</em>
à des valeurs en utilisant des variables en guise d&#8217;identifiant d&#8217;index :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/dynamic.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const SOCIAL_NETWORK = 'twitter';

const francine = {
  first_name: 'Francine',
  location: 'Drôme',
  [SOCIAL_NETWORK]: '@FrancineDu26',    <b class="conum">(1)</b>
};

console.log(francine[SOCIAL_NETWORK]);  <b class="conum">(2)</b>

// manières équivalentes, sans utilisation de variable
console.log(francine.twitter);
console.log(francine['twitter']);</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Assigne la chaîne <code>@FrancineDu26</code> dans l&#8217;index correspondant
à la valeur de la variable <code>SOCIAL_NETWORK</code></p>
</li>
<li>
<p>Affiche <code>"@FrancineDu26"</code></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="object-destructuring">8.1. Décomposition d&#8217;objet (<em>destructuring</em>)</h3>
<div class="paragraph">
<p>L&#8217;affectation par décomposition (<em>destructuring</em>) est une manière
élégante de piocher une ou plusieurs valeurs dans un <a href="#object">objet</a>.
Ce mécanisme existe aussi pour les <a href="#array-destructuring">tableaux</a>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/destructuring.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
  twitter: '@FrancineDu26',
};

const {location,twitter} = francine;
console.log(location);            <b class="conum">(1)</b>

const {first_name:prenom} = francine;
console.log(prenom);              <b class="conum">(2)</b>

const {is_admin=false} = francine;
console.log(is_admin);            <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"Drôme"</code> — on a décomposé la clé <code>location</code></p>
</li>
<li>
<p>Affiche <code>"Francine"</code>
— on a décomposé puis renommé la clé <code>first_name</code>
en une nouvelle variable : <code>prenom</code></p>
</li>
<li>
<p>Affiche <code>false</code>
— on a décomposé la clé <code>is_admin</code> et comme elle n&#8217;existe pas,
on a spécifié la valeur par défaut <code>false</code>, au lieu de <code>undefined</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>La décomposition se combine agréablement avec l&#8217;opérateur <code>&#8230;&#8203;</code>
(opérateur <em>spread</em>).
Il accumule <em>le reste</em> des éléments dans une variable,
sous forme d&#8217;objet.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/destructuring-rest.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
  twitter: '@FrancineDu26',
};

const {first_name, ...metadata} = francine;

console.log(first_name);          <b class="conum">(1)</b>
console.log(metadata);            <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"Francine"</code></p>
</li>
<li>
<p>Affiche <code>{ location: "Drôme", twitter: "@FrancineDu26" }</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="object.assign">8.2. Combiner des objets</h3>
<div class="paragraph">
<p><code>Object.assign</code> est une méthode qui permet d&#8217;étendre et combiner plusieurs tableaux.
On a le choix d&#8217;intégrer les nouveaux éléments à un objet existant
ou bien d&#8217;en créer un nouveau.
Les objets sont combinés dans le premier paramètre de la fonction.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/assign.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
};

const francine26 = Object.assign({}, francine, {location: 'Drôme'});
console.log(francine26);      <b class="conum">(1)</b>
console.log(francine);        <b class="conum">(2)</b>

Object.assign(francine26, {location: 'Paris'}, {location: 'Ardèche'});
console.log(francine26);      <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>{ first_name: "Francine", location: "Drôme" }</code>
— la nouvelle variable contient nos deux objets combinés</p>
</li>
<li>
<p>Affiche <code>{ first_name: "Francine" }</code>
— ce sont les valeurs originelles de notre objet</p>
</li>
<li>
<p>Affiche <code>{ first_name: "Francine", location: 'Ardèche' }</code>
— l&#8217;objet <code>francine26</code> a reçu la nouvelle propriété <code>location</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>À noter que les assignations se font de <em>gauche à droite</em>.
Toute clé existante est remplacée.</p>
</div>
<div class="paragraph">
<p>La <a href="#object-destructuring">décomposition d&#8217;objet</a> sert également à combiner
un ou plusieurs objets entre eux.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/destructuring-spread.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
};

const francine26 = {...francine, location: 'Drôme'};
console.log(francine26);      <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>{ first_name: "Francine", location: "Drôme" }</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="itérer_sur_des_objets">8.3. Itérer sur des objets</h3>
<div class="paragraph">
<p>La méthode <code>Object.entries</code> est probablement la méthode
la plus adaptée pour itérer à la fois sur les <em>clés</em> et sur les <em>valeurs</em>
d&#8217;un objet.
<code>Object.entries</code> est une fonction qui retourne un tableau.
Ce tableau contient autant de paires de <code>[clé, valeur]</code> qu&#8217;il y a
d&#8217;éléments dans l&#8217;objet.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/entries.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

console.log(Object.entries(francine)); <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>[[ "first_name", "Francine" ], [ "location", "Drôme" ]]</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Libre à nous d'<a href="#array.forEach">itérer sur les valeurs</a>
et d&#8217;utiliser la <a href="#array-destructuring">décomposition de tableaux</a>
pour rendre notre code explicite :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/entries-loop.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

Object.entries(francine).forEach(([key, value]) =&gt; {
  console.log(`francine.${key} vaut ${value}`);   <b class="conum">(1)</b>
})

// même résultat, autre méthode
for (const [key, value] of Object.entries(francine)) {
  console.log(`francine.${key} vaut ${value}`);   <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche successivement <code>"francine.first_name vaut Francine"</code>
puis <code>"francine.location vaut Drôme"</code></p>
</li>
<li>
<p>Idem</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Deux autres méthodes récupèrent
soit <em>la liste des clés</em> d&#8217;un objet (<code>Object.keys</code>)
soit <em>la liste des valeurs</em> d&#8217;un objet (<code>Object.values</code>).
Dans les deux cas, les résultats sont retournés
sous forme d&#8217;un <a href="#array">tableau</a>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/keys.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

console.log(Object.keys(francine));     <b class="conum">(1)</b>
console.log(Object.values(francine));   <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>["first_name", "location"]</code></p>
</li>
<li>
<p>Affiche <code>["Francine", "Drôme"]</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="identifier_une_ou_plusieurs_valeurs">8.4. Identifier une ou plusieurs valeurs</h3>
<div class="paragraph">
<p>Il y a trois manières d&#8217;identifier si un objet contient une valeur
associée à une clé.</p>
</div>
<div class="paragraph">
<p>Le plus simple est d&#8217;utiliser la méthode <code>hasOwnProperty</code>.
Elle prend en argument le nom de la clé à tester et
retourne un <a href="#boolean">booléen</a>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/has-own-property.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

console.log(francine.hasOwnProperty('location'));   <b class="conum">(1)</b>
console.log(francine.hasOwnProperty('twitter'));    <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>true</code></p>
</li>
<li>
<p>Affiche <code>false</code> — cette clé n&#8217;existe pas dans cet objet</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>La seconde manière est d&#8217;utiliser l&#8217;opérateur <code>in</code>.
On l&#8217;aura déjà rencontré lors des <a href="#array.forEach">boucles</a>.
Sauf que cette fois, on l&#8217;utilise une seule fois — et non dans une boucle.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/key-in.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

console.log('location' in francine);   <b class="conum">(1)</b>
console.log('twitter' in francine);    <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>true</code></p>
</li>
<li>
<p>Affiche <code>false</code> — cette clé n&#8217;existe pas dans cet objet</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Enfin, on peut tester la valeur associée avec la syntaxe standard <code>objet.clé</code>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/key.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
};

console.log(Boolean(francine.location));   <b class="conum">(1)</b>
console.log(Boolean(francine.twitter));    <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>true</code></p>
</li>
<li>
<p>Affiche <code>false</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Attention toutefois, car cette méthode <em>teste uniquement la valeur</em>.
Si la clé existe et contient <code>undefined</code>, vous ne verrez pas la différence.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">object/key-undefined.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const francine = {
  first_name: 'Francine',
  location: 'Drôme',
  twitter: undefined
};

console.log(Boolean(francine.twitter));          <b class="conum">(1)</b>
console.log(francine.twitter !== undefined);     <b class="conum">(2)</b>

console.log(francine.hasOwnProperty('twitter')); <b class="conum">(3)</b>
console.log('twitter' in francine);              <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>false</code>
— la valeur <code>undefined</code> est convertie en <code>false</code></p>
</li>
<li>
<p>Affiche <code>false</code>
— la clé existe bien, mais elle contient la valeur <code>undefined</code></p>
</li>
<li>
<p>Affiche <code>true</code> — le test se fait sur l&#8217;existence de la clé</p>
</li>
<li>
<p>Affiche <code>true</code> — idem</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="json">9. Manipuler des structures de données JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JSON (<span class="URL"><a href="http://json.org" class="bare">json.org</a></span>) est un format de données textuel standardisé.
Son but est de pouvoir <strong>représenter des données informatiques</strong> de manière
interopérable entre différents langages.</p>
</div>
<div class="listingblock">
<div class="title">json/base.json</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  "title": "Node.js",
  "price_tag": 32,
  "keywords": [
    "JavaScript",
    "Node.js",
    "Apprendre par l'exemple"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le format JSON ressemble beaucoup à une structure d'<a href="#object">objet</a> ECMAScript.
La représentation est plus stricte car <em>toute donnée</em> doit être représentée
de manière textuelle.
Ainsi, toutes les clés sont entourées de <em>guillemets doubles</em>.</p>
</div>
<div class="paragraph">
<p>Les types de données autorisés sont les nombres, les chaînes de caractère,
les booléens, les tableaux, les objets et la valeur <code>null</code>.
On ne peut donc pas représenter de <a href="#function">fonction</a>,
d'<a href="#class">instance d&#8217;objet</a> ni même la valeur <code>undefined</code>.</p>
</div>
<div class="paragraph">
<p>ECMAScript embarque le nécessaire pour <em>parser</em> depuis et <em>convertir</em> en JSON.
Cela se fait respectivement avec les fonctions <code>JSON.parse</code> et <code>JSON.stringify</code>.</p>
</div>
<div class="paragraph">
<p>La fonction <code>JSON.parse</code> consomme du texte.
Elle retourne une représentation ECMAScript ou lance une <a href="#error">erreur</a>
en cas de problème.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">json/parse.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const json_object = '{ "title": "Node.js", "price_tag": 32 }';
const json_string = '"Hello World!"';
const json_number = '32';

console.log(JSON.parse(json_string)); <b class="conum">(1)</b>
console.log(JSON.parse(json_number)); <b class="conum">(2)</b>
console.log(JSON.parse(json_object)); <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"Hello World!"</code></p>
</li>
<li>
<p>Affiche <code>32</code></p>
</li>
<li>
<p>Affiche <code>{price_tag: 32, title: "Node.js"}</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>À l&#8217;inverse, la fonction <code>JSON.stringify</code> convertit une structure ECMAScript
en chaîne de caractères au format JSON :</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">json/stringify.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const json_object = '{ "title": "Node.js", "price_tag": 32 }';
const json_string = '"Hello World!"';
const json_number = '32';

console.log(JSON.parse(json_string)); <b class="conum">(1)</b>
console.log(JSON.parse(json_number)); <b class="conum">(2)</b>
console.log(JSON.parse(json_object)); <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>La fonction <code>JSON.stringify</code> parcourt tous les éléments
pour les sérialiser en forme textuelle.
Dans le cas de <a href="#object">structures d&#8217;objet</a>, on peut définir
une fonction de conversion dans la clé <code>toJSON</code>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">json/to-json.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const location = {
  lat: 48.8503439,
  lon: 2.34658949,
  toJSON() {
    return `geo=${this.lat},${this.lon}`;
  }
}

console.log(JSON.stringify(location));    <b class="conum">(1)</b>

delete location.toJSON;
console.log(JSON.stringify(location));    <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"\"geo=48.8503439,2.34658949\""</code>
— c&#8217;est la sérialisation definie par notre fonction <code>toJSON</code></p>
</li>
<li>
<p>Affiche <code>"{\"lat\":48.8503439,\"lon\":2.34658949}"</code>
— sans la clé <code>toJSON</code>, notre objet initial est sérialisé tel quel</p>
</li>
</ol>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> JSON</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur JSON.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/JSON" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/JSON</a>

</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="date">10. Manipuler des dates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les calculs de date s&#8217;effectuent à l&#8217;aide des objets <code>Date</code>.
Chaque instance de <code>Date</code> représente un moment dans le temps, à un jour
et à une heure donnée.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">date/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const now = new Date();
const past = new Date('2013-12-04 10:00:00'); <b class="conum">(1)</b>

console.log(past.getUTCFullYear());           <b class="conum">(2)</b>
console.log(now.getUTCFullYear());            <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>On initialise l&#8217;objet date <code>past</code> au 14 décembre 2013</p>
</li>
<li>
<p>Affiche <code>2013</code> — l&#8217;année liée à l&#8217;objet <code>past</code></p>
</li>
<li>
<p>Affiche <code>2018</code> — l&#8217;année liée à l&#8217;objet <code>now</code> (aujourd&#8217;hui)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Un certain nombre de méthodes <em>retournent</em> différents éléments de la date
contenue dans l&#8217;objet : année, secondes, jour de la semaine, etc.
Il en existe tout autant pour <em>modifier</em> ces éléments de date.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">date/set.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const past = new Date('2013-12-04 10:00:00');

past.setUTCFullYear('2015');           <b class="conum">(1)</b>
console.log(past.toISOString());       <b class="conum">(2)</b>

past.setUTCMonth(1);                   <b class="conum">(3)</b>
console.log(past.toISOString());       <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Change la date vers l&#8217;année <code>2015</code></p>
</li>
<li>
<p>Affiche <code>"2015-12-04T10:00:00.000Z"</code></p>
</li>
<li>
<p>Change la date vers le mois <code>1</code></p>
</li>
<li>
<p>Affiche <code>"2015-02-04T10:00:00.000Z"</code>… mais, c&#8217;est le mois de février ?!</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent illustre l&#8217;ambiguïté de la notion de <em>mois</em>.
Il s&#8217;agit en réalité de l'<em>index du mois</em> :
0 correspond à janvier, 1 à février, etc.</p>
</div>
<div class="paragraph">
<p>La plupart des méthodes natives font référence à l&#8217;anglais.
Elles offrent peu de confort de manipulation — on aimerait pouvoir
compter facilement le nombre de jours entre deux dates, ou retirer 30 jours.</p>
</div>
<div class="paragraph">
<p>Quand nous utiliserons <a href="#../chapter-04/index.adoc">Node</a> et
<a href="#../chapter-05/index.adoc">npm</a>, nous verrons que nous aurons
à disposition des librairies facilitant les manipulations de dates.</p>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Date</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Date.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/Date" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/Date</a>

</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="intl.datetimeformat">10.1. Formatage internationalisé (<em>Intl.DateTimeFormat</em>)</h3>
<div class="paragraph">
<p>La spécification <em>ECMA Intl</em> a été conçue pour ajouter des
fonctionnalités relatives aux langues.
Cette spécification est complémentaire.
Son comportement varie en fonction du système d&#8217;exploitation
— mode d&#8217;installation de Node et/ou version du navigateur web.</p>
</div>
<div class="paragraph">
<p>Les méthodes de date <code>toLocaleString</code>, <code>toLocaleDateString</code> et
<code>toLocaleTimeString</code> renvoient une version localisée
d&#8217;une date complète, d&#8217;une date et d&#8217;une heure, respectivement.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">date/to-locale-date.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const past = new Date('2013-12-04 10:00:00');

console.log(past.toLocaleDateString());
console.log(past.toLocaleDateString('fr-FR', { month: 'long' }));</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>04/12/2013</code></p>
</li>
<li>
<p>Affiche <code>décembre</code></p>
</li>
</ol>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">⚠️</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Attention</span> Tu vois M01, M02, etc. ?</div>
<div class="paragraph">
<p>Si en formatant une date, les caractères <code>M01</code>, <code>M02</code> ou autre s&#8217;affiche,
c&#8217;est que le système n&#8217;est pas configuré avec les libellés de la langue
demandée.</p>
</div>
<div class="paragraph">
<p>La langue par défaut est l&#8217;anglais.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Date/toLocaleDateString</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Date/toLocaleDateString.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString</a>

</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Une version plus verbeuse consiste à créer un formateur avec
<code>Intl.DateTimeFormat</code>.
Ce formateur se réutilise pour transformer plusieurs fois
des dates différentes avec les mêmes réglages…
ou une même date avec des formatages différents.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">date/intl.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const past = new Date('2013-12-04 10:00:00');

const options = { year: 'numeric', month: 'short', day: 'numeric' };
const longOptions = {...options, weekday: 'long', month: 'long'};
const fr = new Intl.DateTimeFormat('fr-FR', options);
const frLong = new Intl.DateTimeFormat('fr-FR', longOptions);

console.log(fr.format(past));
console.log(frLong.format(past));</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>4 déc. 2013</code></p>
</li>
<li>
<p>Affiche <code>mercredi 4 décembre 2013</code></p>
</li>
</ol>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> DateTimeFormat</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur DateTimeFormat.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/DateTimeFormat" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/DateTimeFormat</a>

</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="class">11. Manipuler des classes d&#8217;objet (<em>Class</em>)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une classe est une <strong>structure qui partage des propriétés</strong>
et des méthodes entre objets qui l&#8217;instancient.
Une instance de classe est créée en préfixant un appel de fonction
par l&#8217;opérateur <code>new</code>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const date1 = new Date();
const date2 = new Date('2013-12-04');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si on se réfère à l&#8217;exemple précédent,
nos deux variables sont des objets issus de la <em>classe</em> <a href="#date">Date</a>.
Chacune des variables bénéficie des méthodes définies par la classe <code>Date</code>.</p>
</div>
<div class="paragraph">
<p>Autrement dit, si les <a href="#object">structures d&#8217;objet</a> définissent des données,
les classes définissent des <strong>comportements partagés</strong>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">class/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">class Book {
  constructor({ title, ean13 }) {     <b class="conum">(1)</b>
    this.title = title;               <b class="conum">(2)</b>
    this.ean13 = ean13;
  }

  toJSON() {                          <b class="conum">(3)</b>
    const {title, ean13} = this;
    return {title, ean13};
  }

  get isbn() {                        <b class="conum">(4)</b>
    return this.ean13.split(3)[1];
  }

  static clean(value) {               <b class="conum">(5)</b>
    return value.replace(/\D/g, '');
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Le constructeur reçoit un ou plusieurs arguments lors de l&#8217;instanciation
de la classe</p>
</li>
<li>
<p><code>this</code> fait référence à <em>ce contexte</em>,
c&#8217;est-à-dire à <em>cette instance de classe</em> ;
deux instances peuvent être initialisées avec des données différentes</p>
</li>
<li>
<p><code>toJSON</code> est une méthode de la classe</p>
</li>
<li>
<p><code>isbn</code> est un accesseur (préfixe <code>get</code>)
— une propriété dont la valeur est calculée à chaque fois qu&#8217;elle est appelée</p>
</li>
<li>
<p><code>clean</code> est une méthode dite <em>statique</em>
— elle est appelée en dehors d&#8217;une instance</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Nous développerons cet exemple dans les sections qui suivent.
On peut d&#8217;ores et déjà noter que la structure d&#8217;une classe
se décompose en plusieurs parties :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">la définition</dt>
<dd>
<p>Définit le nom de la classe que l&#8217;on pourra instancier.</p>
</dd>
<dt class="hdlist1">le constructeur</dt>
<dd>
<p>Partie exécutée lorsque la classe est instanciée.
On y met le moins de choses possibles.
En général on copie les données passées en argument.</p>
</dd>
<dt class="hdlist1">les méthodes</dt>
<dd>
<p>Fonctions partagées entre toutes les instances de la classe.</p>
</dd>
<dt class="hdlist1">les méthodes statiques</dt>
<dd>
<p>Fonctions partagées sans avoir à instancier la classe.</p>
</dd>
<dt class="hdlist1">les accesseurs et mutateurs</dt>
<dd>
<p>Fonctions qui définissent le comportement de propriétés dynamiques.</p>
</dd>
<dt class="hdlist1">le contexte (<code>this</code>)</dt>
<dd>
<p>On peut y référer dans les méthodes de la classe pour dire
<em>je fais référence à cet objet</em>.
Et donc d&#8217;appeler les données et méthodes attenantes.</p>
</dd>
</dl>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Classes</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Classes.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Classes" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Classes</a>

</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="class.method">11.1. Méthodes d&#8217;instance</h3>
<div class="paragraph">
<p>Les méthodes définissent des comportements partagés entre chaque instance
de la classe.
Elles servent à <em>retourner</em> ou <em>transformer</em> des valeurs rattachées à l&#8217;objet.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">class/methods.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">class Book {
  constructor({ title }) {
    this.title = title;
  }

  isPublished() {
    return this.is_published === true;
  }

  publish() {
    this.is_published = true;
  }
}

const book1 = new Book({ title: 'Node.js' });
console.log(book1.isPublished());   <b class="conum">(1)</b>
book1.publish();
console.log(book1.isPublished());   <b class="conum">(2)</b>

const book2 = new Book({ title: 'CSS maintenables' });
console.log(book2.isPublished());   <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>false</code>
— la propriété n&#8217;existe pas</p>
</li>
<li>
<p>Affiche <code>true</code>
— la propriété <code>is_published</code> a été changée à la ligne précédente</p>
</li>
<li>
<p>Affiche <code>false</code>
— les données sont étanches entre chaque instance</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="class.static">11.2. Méthodes statiques</h3>
<div class="paragraph">
<p>Les méthodes statiques sont pratiques pour mettre à disposition du code
métier de manière organisée.
Elles se caractérisent par le préfixe <code>static</code> devant un nom de fonction.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">class/static.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">class Book {
  constructor({ title, ean13 }) {
    this.title = title;
    this.ean13 = ean13;
  }

  static clean(value) {
    return value.replace(/\D/g, '');
  }
}

const nodebook = new Book({
  title: 'Node.js',
  ean13: Book.clean('978-2212139938'),  <b class="conum">(1)</b>
});

console.log(nodebook.ean13);            <b class="conum">(2)</b>
console.log(nodebook.clean);            <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>On appelle la méthode statique <code>Book.clean</code> pour nettoyer le code EAN13</p>
</li>
<li>
<p>Affiche <code>"9782212139938"</code>
— la valeur a bien été nettoyée</p>
</li>
<li>
<p>Affiche <code>undefined</code>
— les méthodes statiques ne sont pas accessibles depuis l&#8217;instance de classe</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On verra dans le <a href="#../chapter-04/index.adoc">chapitre sur Node</a>
qu&#8217;on peut se baser sur les modules pour partager du code
sans avoir à l&#8217;affecter à une classe.</p>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Classes/static</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Classes/static.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Classes/static" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Classes/static</a>

</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="object-getset">11.3. Accesseurs et mutateurs</h3>
<div class="paragraph">
<p>Ce type particulier de méthode permet en réalité de définir des
<em>attributs dynamiques</em> mais aussi de gérer comment l&#8217;affectation de données.
Elles se caractérisent par le préfixe <code>get</code> ou <code>set</code> devant un nom de fonction,
selon que ça soit un <em>accesseur</em> ou un <em>mutateur</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">class/getters.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">class Book {
  constructor({ title, ean13 }) {
    this.title = title;
    this.ean13 = ean13;
  }

  get isbn() {
    return this.ean13.slice(3);
  }
}

const nodebook = new Book({ title: 'Node.js', ean13: '9782212139938' });

console.log(nodebook.ean13);  <b class="conum">(1)</b>
console.log(nodebook.isbn);   <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"9782212139938"</code>
— c&#8217;est une propriété de l&#8217;objet <code>nodebook</code></p>
</li>
<li>
<p>Affiche <code>"2212139938"</code>
— la valeur est calculée dynamiquement à partir de la valeur de <code>nodebook.ean13</code></p>
</li>
</ol>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Functions/get</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Functions/get.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Functions/get" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Functions/get</a>

</td>
</tr>
</table>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Functions/set</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Functions/set.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Functions/set" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Functions/set</a>

</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="class.extends">11.4. Héritage</h3>
<div class="paragraph">
<p>L&#8217;héritage est un mécanisme d&#8217;extension de classe.
C&#8217;est une pratique peu employée en JavaScript,
principalement de par sa nature modulaire et fonctionnelle.</p>
</div>
<div class="paragraph">
<p>L&#8217;héritage se caractérise par l&#8217;usage de l&#8217;opérateur <code>extends</code> lors de la
définition de la classe et aussi par l&#8217;utilisation du mot-clé <code>super</code>
dans le constructeur.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">class/extends.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">class Product {
  constructor({ ean13 }) {
    this.ean13 = ean13;
  }
}

class Book extends Product {
  constructor(options) {
    super(options);

    this.title = options.title;
  }
}

const nodebook = new Book({ title: 'Node.js', ean13: '9782212139938' });
console.log(nodebook.title);    <b class="conum">(1)</b>
console.log(nodebook.ean13);    <b class="conum">(2)</b>

const nodeproduct = new Product({ title: 'Node.js', ean13: '9782212139938' });
console.log(nodeproduct.title); <b class="conum">(3)</b>
console.log(nodeproduct.ean13); <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>"Node.js"</code>
— la propriété <code>title</code> est assignée dans le constructeur de la classe <code>Book</code></p>
</li>
<li>
<p>Affiche <code>"9782212139938"</code>
— la propriété <code>ean13</code> est assignée dans le constructeur de <code>Product</code>,
la classe dont on hérite grâce à <code>extends</code>
et à l&#8217;appel de <code>super()</code> qui transmet les arguments d&#8217;initialisation</p>
</li>
<li>
<p>Affiche <code>undefined</code>
— la propriété <code>title</code> n&#8217;est pas assignée dans le constructeur de
la classe <code>Product</code></p>
</li>
<li>
<p>Affiche <code>"9782212139938"</code>
— la propriété <code>ean13</code> est assignée dans le constructeur de <code>Product</code>
qu&#8217;on appelle directement cette fois-ci</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>En pratique, c&#8217;est comme si on empilait les classes les unes sur les autres.
On lègue des méthodes aux classes qui héritent.
Si une méthode porte le même nom, elle sera écrasée.</p>
</div>
<div class="paragraph">
<p>L&#8217;appel à la fonction <code>super()</code> <em>appelle le constructeur de la classe étendue</em>.
Si on ne l&#8217;appelle pas, le constructeur de la classe parent ne sera pas invoqué.</p>
</div>
<div class="paragraph">
<p>On reparlera de l&#8217;héritage dans la
<a href="../chapter-09/index.html#react">section React</a>
du <a href="#../chapter-09/index.adoc">chapitre 9</a>.
C&#8217;est un exemple populaire d&#8217;héritage de composants graphiques.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="promise">12. Manipuler des promesses (<em>Promise</em>)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une promesse est <strong>un objet retourné immédiatement</strong>.
Le <strong>résultat est obtenu plus tard</strong>.
Cette résolution peut être soit <em>positive</em> soit <em>négative</em>.
On dit alors que l&#8217;action est <em>asynchrone</em>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">promise/base.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const p = new Promise((resolve) =&gt; resolve('promesse tenue'));

console.log(p);                           <b class="conum">(1)</b>
console.log('un');                        <b class="conum">(2)</b>
p.then(message =&gt; console.log(message));  <b class="conum">(4)</b>
console.log('deux');                      <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Affiche <code>Promise</code> — ce n&#8217;est pas le résultat que l&#8217;on voit mais l&#8217;objet avec lequel interagir pour être prévenu de la mise à disposition du résultat</p>
</li>
<li>
<p>Affiche <code>"un"</code></p>
</li>
<li>
<p>Affiche <code>"deux"</code>
— c&#8217;est parce que la ligne d&#8217;avant a mis en attente
la <a href="#anonymous-function">fonction anonyme</a></p>
</li>
<li>
<p>Affiche <code>"promesse tenue"</code> en dernier</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">💬</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Design Pattern</span> Executor</div>
<div class="paragraph">
<p>Le fait qu&#8217;une fonction nous passe d'<em>autres fonctions</em> pour commander
un résultat s&#8217;appelle le <em>pattern Executor</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Une <code>Promise</code> s&#8217;orchestre en deux temps.
L'<strong>initialisation</strong> : on décide de la manière dont le traitement asynchrone
sera effectué.
Puis la <strong>résolution</strong> : <em>positive</em> en appelant <code>resolve()</code>
ou <em>négative</em>, en appelant <code>reject()</code>.
Le résultat passé à <code>resolve</code> sera transmis au premier argument de <code>then</code>.
Le résultat passé à <code>reject</code> sera transmis au deuxième argument de <code>then</code>
mais aussi au premier argument de <code>catch</code>.</p>
</div>
<div class="paragraph">
<p>Une instance de <code>Promise</code> expose plusieurs méthodes
pour propager le statut de son exécution.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>then(onSuccess[, onError])</code></dt>
<dd>
<p>Fonction acceptant un <em>callback</em> de résolution et
un <em>callback</em> de rejet (facultatif).</p>
</dd>
<dt class="hdlist1"><code>catch(onError)</code></dt>
<dd>
<p>Fonction acceptant un <em>callback</em> de rejet.</p>
</dd>
</dl>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">promise/then-catch.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const oddTime = (date) =&gt; {
  return new Promise((resolve, reject) =&gt; {
    parseInt(date.getTime() / 1000) % 2                         <b class="conum">(1)</b>
      ? resolve('le nombre de secondes est impair :-)')
      : reject('le nombre de secondes n\'est pas impair :-(');
  });
}

const now = new Date();

oddTime(now)
  .then(msg =&gt; console.log(msg), msg =&gt; console.error(msg)); <b class="conum">(2)</b>

oddTime(new Date(now.getTime() + 1000))                      <b class="conum">(3)</b>
  .then(msg =&gt; console.log(msg))                             <b class="conum">(4)</b>
  .catch(msg =&gt; console.error(msg))                          <b class="conum">(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>La fonction <code>oddTime</code> accepte un argument de type &lt;&lt;date,Date&gt; ;
elle résout la promesse <em>positivement</em> (<code>resolve</code>) si le nombre
de secondes est impair, sinon elle résout la promesse <em>négativement</em> (<code>reject</code>)</p>
</li>
<li>
<p>Utilisation de la forme compacte de <code>then</code> avec deux <em>callbacks</em> :
un de succès (associé à <code>resolve</code>) et un d&#8217;échec (associé à <code>reject</code>)</p>
</li>
<li>
<p>On crée une nouvelle promesse, avec une date calée une seconde plus tard ;
c&#8217;est histoire de s&#8217;assurer que les deux appels aboutissent à une résolution
différente</p>
</li>
<li>
<p>Affiche <code>"le nombre de secondes est impair :-)"</code>
si la résolution est positive</p>
</li>
<li>
<p>Affiche <code>"le nombre de secondes n&#8217;est pas impair :-("</code>
si la résolution est négativement</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">💬</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Histoire</span> Standard <code>Promise/A+</code></div>
<div class="paragraph">
<p>Historiquement, de nombreuses librairies ont proposé leur propre implémentation de promesses.
Elles avaient le défaut de ne pas être interopérables entre elles.
La spécification <em>Promise/A+</em> a émergé pour établir un standard de compatibilité.</p>
</div>
<div class="paragraph">
<p>ECMAScript 2015 introduit nativement cette API.
Plus besoin de <em>polyfill</em> ou de librairie pour en bénéficier nativement.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://github.com/promises-aplus/promises-spec" class="bare">github.com/promises-aplus/promises-spec</a></span></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>En général, on utilise les promesses <strong>pour aller plus vite</strong>.
Parce qu&#8217;on peut continuer à traiter d&#8217;autres actions
<strong>en attendant l&#8217;arrivée du résultat</strong>.</p>
</div>
<div class="paragraph">
<p>C&#8217;est comme quand on se rend au restaurant :
les personnes en cuisine effectuent le traitement des commandes
(actions longues) tandis que les personnes au service gèrent
des interactions plus courtes mais plus fréquentes.
Au final, le ticket de commande contient la liste des promesses dont
on attend la résolution.</p>
</div>
<div class="paragraph">
<p>Nous verrons d&#8217;autres utilisations des promesses
avec <a href="../chapter-09/index.html#io-fetch">fetch()</a> au chapitre 9,
avec <a href="../chapter-04/index.html#util.promisify">promisify</a> au chapitre 4
et dans l'<a href="../appendix-b/index.html#promise">annexe B</a>.</p>
</div>
<div class="admonitionblock  info">
<table>
<tr>
<td class="icon">
<div class="title">📖</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Documentation</span> Promise</div>

Rendez-vous sur <em>MDN web docs</em> pour en savoir plus sur Promise.<br>
<a href="https://developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/Promise" class="bare URL" target="_blank" rel="noopener">developer.mozilla.org/docs/fr/Web/JavaScript/Reference/Global_Objects/Promise</a>

</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">💡</div>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Guide des promesses</div>
<div class="paragraph">
<p>Un guide <em>très</em> complet — en anglais — est publié en libre consultation sur le site du W3C.
Un dépôt sur GitHub permet d&#8217;y contribuer.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://www.w3.org/2001/tag/doc/promises-guide" class="bare">www.w3.org/2001/tag/doc/promises-guide</a></span></p>
</li>
<li>
<p><span class="URL"><a href="https://github.com/w3ctag/promises-guide" class="bare">github.com/w3ctag/promises-guide</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="promise.all">12.1. Collection de promesses</h3>
<div class="paragraph">
<p><code>Promise.all</code> est une <a href="#class.static">méthode statique</a> de la class <em>Promise</em>.
Elle accepte un <a href="#array">tableau</a> de promesses.
<code>Promise.all</code> retourne elle-même une promesse.
Cette promesse est résolue positivement si toutes les promesses réussissent.
Elle est résolue négativement dès que l'<em>une d&#8217;entre elles</em> échoue.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">promise/all.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const asyncRandom = () =&gt; new Promise((resolve) =&gt; {
  const timing = Math.floor(Math.random() * 2000);
  setTimeout(() =&gt; resolve(`résolu après ${timing}ms`), timing);        <b class="conum">(1)</b>
});

const all = Promise.all([asyncRandom(), asyncRandom(), asyncRandom()]); <b class="conum">(2)</b>
all.then(messages =&gt; console.log(messages));                            <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Cette fonction résout la promesse après un délai aléatoire
compris entre 0 et 2000 millisecondes</p>
</li>
<li>
<p>On passe 3 promesses à <code>Promise.all</code></p>
</li>
<li>
<p>La résolution est déclenchée dès que les 3 promesses sont résolues
— l&#8217;argument contient un tableau listant les résultats
<em>dans l&#8217;ordre initial</em> des promesses</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent illustre la <strong>parallélisation des actions</strong>.
Si la promesse la plus longue prend 1 seconde à être résolue,
alors le temps d&#8217;attente pour la résolution de <em>toutes les promesses</em>
est de 1 seconde.<br>
Si on avait été dans un enchainement séquentiel, le temps d&#8217;attente
final aurait été l&#8217;accumulation des temps d&#8217;attente de la résolution
de chacune des promesses.</p>
</div>
<div class="paragraph">
<p>Les promesses sont un des meilleurs moyens à notre disposition pour
<strong>modulariser</strong>, <strong>linéariser</strong> et <strong>clarifier le sens</strong> du flot de notre code.</p>
</div>
</div>
<div class="sect2">
<h3 id="async-await">12.2. async/await</h3>
<div class="paragraph">
<p>Les opérateurs <code>async</code> et <code>await</code> aident à mettre en pause
l&#8217;interpréteur ECMAScript, en attendant le résultat d&#8217;une
fonction asynchrone (préfixée par <code>async</code>).
Les <a href="#promise">promesses</a> sont implicitement compatibles.
On peut donc les mettre à plat pour obtenir un résultat
sans avoir à utiliser <code>then</code> ni <code>catch</code>.</p>
</div>
<div class="paragraph">
<p>Transformons l&#8217;exemple de la section <a href="#promise.all">Promise.all</a>
pour comprendre l&#8217;impact de <code>async</code> et de <code>await</code>.</p>
</div>
<div class="listingblock interactive interactive--javascript">
<div class="title">promise/async-await.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function asyncRandom() {
  return new Promise((resolve) =&gt; {
    const timing = Math.floor(Math.random() * 2000);
    setTimeout(() =&gt; resolve(`résolu après ${timing}ms`), timing);
  });
}

(async () =&gt; {                                                    <b class="conum">(1)</b>
  const all = [
    await asyncRandom(), await asyncRandom(), await asyncRandom() <b class="conum">(2)</b>
  ];

  console.log(all);                                               <b class="conum">(3)</b>
})();</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>On crée une <em>fonction asynchrone auto-invoquée</em>
— c&#8217;est pas pour frimer mais parce qu&#8217;on ne peut pas encore utiliser
de fonction asynchrone directement au niveau principal d&#8217;un script</p>
</li>
<li>
<p>Chaque utilisation de <code>await</code> met l&#8217;interpréteur en pause</p>
</li>
<li>
<p>L&#8217;affichage du temps d&#8217;exécution de chaque promesse se fait
lorsque les 3 promesses sont résolues.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On gagne en lisibilité, mais <strong>on perd en vitesse</strong>.
Les promesses sont exécutées <em>les unes à la suite des autres</em>
et non plus en parallèle.
Il est important d&#8217;arbitrer les choix de <em>design</em> et d&#8217;éviter de bloquer
l&#8217;exécution de vos scripts sans raison explicite.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion">13. Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ECMAScript est un langage bien plus riche, complet et élégant qu&#8217;il n&#8217;y parait.</p>
</div>
<div class="paragraph">
<p>Ce chapitre nous a <strong>appris les différentes structures de langage</strong>
communes à toutes les environnements comprenant ECMAScript.
Cela s&#8217;applique aussi bien à Node qu&#8217;aux navigateurs web.<br>
Je vous invite à revenir à ce chapitre pour vous rafraîchir la mémoire
mais aussi pour <strong>jouer avec les exemples</strong> afin de confirmer votre compréhension
du langage.</p>
</div>
<div class="paragraph">
<p>Dans le <a href="#../chapter-04/index.adoc">chapitre suivant</a>, nous allons
<strong>relier ces apprentissages avec Node</strong> — l&#8217;interpréteur et l&#8217;environnement
d&#8217;exécution JavaScript que nous avons appris à installer au
<a href="#../chapter-02/index.adoc">chapitre 2</a>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Dernière mise à jour 2018-03-06 20:18:41 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>